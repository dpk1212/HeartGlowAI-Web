(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[417],{7532:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/create",function(){return a(9907)}])},1798:function(e,t,a){"use strict";a.d(t,{HE:function(){return addConnection},HZ:function(){return updateConnection},Qf:function(){return updateConnectionWithMessage},RU:function(){return getConnectionFrequency},Rd:function(){return deleteConnection},S7:function(){return fetchUserConnections},SY:function(){return formatRelativeTime},db:function(){return n.db},eA:function(){return fetchUserMessages}});var r=a(6100),n=a(4417);let getConnectionFrequency=e=>{if(!e.messageCount||0===e.messageCount)return"new";if(!e.lastMessageDate)return"recent";let t=new Date,a=e.lastMessageDate.toDate(),r=Math.floor((t.getTime()-a.getTime())/864e5);return r<=7?"frequent":r<=30?"recent":"new"},fetchUserConnections=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;if(!e)return console.log("No authenticated user found for fetching connections"),[];try{console.log("Fetching connections for user ID: ".concat(e.uid));let a=(0,r.hJ)(n.db,"users/".concat(e.uid,"/connections")),o=(0,r.IO)(a,(0,r.Xo)("updatedAt","desc"),(0,r.b9)(t));console.log("Executing Firestore query for connections");let i=await (0,r.PL)(o);console.log("Retrieved ".concat(i.docs.length," connections from Firestore"));let s=i.docs.map(e=>{let t=e.data();return console.log("Connection found - ID: ".concat(e.id,", Name: ").concat(t.name,", Relationship: ").concat(t.relationship)),{id:e.id,...t}});return s}catch(e){return console.error("Error fetching connections:",e),[]}},fetchUserMessages=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;if(!e)return console.log("No authenticated user found for fetching messages"),[];try{console.log("Fetching messages for user ID: ".concat(e.uid));let a=(0,r.hJ)(n.db,"users/".concat(e.uid,"/messages")),o=(0,r.IO)(a,(0,r.Xo)("createdAt","desc"),(0,r.b9)(t));console.log("Executing Firestore query for messages");let i=await (0,r.PL)(o);console.log("Retrieved ".concat(i.docs.length," messages from Firestore"));let s=i.docs.map(e=>{let t=e.data();return console.log("Message found - ID: ".concat(e.id,", Recipient: ").concat(t.recipientName)),{id:e.id,...t}});return s}catch(e){return console.error("Error fetching messages:",e),[]}},addConnection=async(e,t)=>{if(!e)throw Error("User not authenticated");try{let a=(0,r.hJ)(n.db,"users/".concat(e.uid,"/connections")),o=r.EK.now(),i={...t,createdAt:o,updatedAt:o,messageCount:0},s=await (0,r.ET)(a,i);return{id:s.id,...i}}catch(e){throw console.error("Error adding connection:",e),e}},updateConnectionWithMessage=async(e,t)=>{if(e&&t)try{let a=(0,r.JU)(n.db,"users/".concat(e.uid,"/connections/").concat(t));await (0,r.r7)(a,{messageCount:(0,r.nP)(1),lastMessageDate:(0,r.Bt)(),updatedAt:(0,r.Bt)()}),console.log("Updated connection ".concat(t," with new message info."))}catch(e){console.error("Error updating connection ".concat(t," after message:"),e)}},updateConnection=async(e,t)=>{if(!e)throw Error("User not authenticated");try{let a=(0,r.JU)(n.db,"users/".concat(e.uid,"/connections/").concat(t.id)),o={...t,updatedAt:r.EK.now()};delete o.id,await (0,r.r7)(a,o);let i=await (0,r.QT)(a);return{id:t.id,...i.data()}}catch(e){throw console.error("Error updating connection:",e),e}},formatRelativeTime=e=>{if(!e)return"Never";let t=new Date,a=e.toDate(),r=t.getTime()-a.getTime(),n=Math.floor(r/864e5),o=Math.floor(r%864e5/36e5),i=Math.floor(r%36e5/6e4);return n>30?"".concat(Math.floor(n/30)," ").concat(1===Math.floor(n/30)?"month":"months"," ago"):n>0?"".concat(n," ").concat(1===n?"day":"days"," ago"):o>0?"".concat(o," ").concat(1===o?"hour":"hours"," ago"):i>0?"".concat(i," ").concat(1===i?"minute":"minutes"," ago"):"Just now"},deleteConnection=async(e,t)=>{if(!e)throw Error("User not authenticated");try{console.log("Deleting connection with ID: ".concat(t," for user: ").concat(e.uid));let a=(0,r.JU)(n.db,"users/".concat(e.uid,"/connections/").concat(t));return await (0,r.oe)(a),console.log("Successfully deleted connection with ID: ".concat(t)),!0}catch(e){throw console.error("Error deleting connection:",e),e}}},3278:function(e,t,a){"use strict";a.d(t,{B:function(){return useChallenges}});var r=a(7294),n=a(6100),o=a(4417);function useChallenges(){let[e,t]=(0,r.useState)([]),[a,i]=(0,r.useState)(!0),[s,l]=(0,r.useState)(null);return(0,r.useEffect)(()=>{let fetchChallenges=async()=>{i(!0),l(null);try{console.log("[useChallenges] Fetching active challenge definitions...");let e=(0,n.hJ)(o.db,"challenges"),a=(0,n.IO)(e,(0,n.ar)("isActive","==",!0)),r=await (0,n.PL)(a),i=r.docs.map(e=>({id:e.id,...e.data()}));console.log("[useChallenges] Fetched ".concat(i.length," active challenges.")),t(i)}catch(e){console.error("[useChallenges] Error fetching challenges:",e),l(e)}finally{i(!1)}};fetchChallenges()},[]),{challenges:e,loading:a,error:s}}},8477:function(e,t,a){"use strict";a.d(t,{db:function(){return l},l2:function(){return s}});var r=a(3977),n=a(9451),o=a(6100),i=a(8887);let s=(0,r.C6)().length?(0,r.C6)()[0]:(0,r.ZF)({apiKey:"AIzaSyBZiJPTs7dMccVgFV-YoTejnhy1bZNFEQY",authDomain:"heartglowai.firebaseapp.com",projectId:"heartglowai",storageBucket:"heartglowai.firebasestorage.app",messagingSenderId:"196565711798",appId:"1:196565711798:web:79e2b0320fd8e74ab0df17",measurementId:"G-KJMPL1DNPY"});(0,n.v0)(s);let l=(0,o.ad)(s);(0,i.Gb)().then(e=>e?(0,i.IH)(s):null)},9907:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return CreatePage}});var r=a(5893),n=a(7294),o=a(1163),i=a(8549),s=a(8477),l=a(6100),c=a(3495),d=a(1012),g=a(1664),u=a.n(g);function RecipientStep(e){let{onNext:t,initialData:a}=e;console.log(">>> RecipientStep component rendering started");let{currentUser:o}=(0,i.a)(),[g,h]=(0,n.useState)([]),[m,p]=(0,n.useState)(!0),[f,y]=(0,n.useState)((null==a?void 0:a.recipient)||null),[x,b]=(0,n.useState)(null);(0,n.useEffect)(()=>{let fetchRecipients=async()=>{if(o)try{let e=(0,l.hJ)(s.db,"users",o.uid,"connections"),t=(0,l.IO)(e),a=await (0,l.PL)(t),r=a.docs.map(e=>({id:e.id,...e.data()}));h(r)}catch(e){b("Failed to load recipients. Please try again."),console.error("Error fetching recipients:",e)}finally{p(!1)}};fetchRecipients()},[o]),(0,n.useEffect)(()=>{if(null==a?void 0:a.recipient){let e=g.some(e=>e.id===a.recipient.id);e?y(a.recipient):g.length>0&&console.warn("Initial recipient not found in the current list.")}},[a,g]);let handleSelect=e=>{y(e)};return m?(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-heartglow-pink"})}):(0,r.jsxs)("div",{className:"space-y-8 dark:text-heartglow-offwhite",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Who would you like to message?"}),(0,r.jsx)(u(),{href:"/connections",legacyBehavior:!0,children:(0,r.jsxs)("a",{className:"inline-flex items-center px-4 py-2 border border-gray-600 text-sm font-medium rounded-md shadow-sm text-gray-300 bg-gray-700 hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-heartglow-pink focus:ring-offset-gray-900 transition-colors",children:[(0,r.jsx)(d.Z,{size:16,className:"-ml-1 mr-2"}),"Add Connection"]})})]}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400 text-center",children:"Select a recipient from your connections"}),x&&(0,r.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative dark:bg-red-900/30 dark:border-red-700/50 dark:text-red-300",role:"alert",children:x}),(0,r.jsx)("div",{className:"grid gap-4",children:0===g.length?(0,r.jsxs)("div",{className:"text-center py-12",children:[(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400 mb-4",children:"No recipients found."}),(0,r.jsx)(u(),{href:"/connections",legacyBehavior:!0,children:(0,r.jsxs)("a",{className:"inline-flex items-center px-4 py-2 border border-gray-600 text-sm font-medium rounded-md shadow-sm text-gray-300 bg-gray-700 hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-heartglow-pink focus:ring-offset-gray-900 transition-colors",children:[(0,r.jsx)(d.Z,{size:16,className:"-ml-1 mr-2"}),"Add Your First Connection"]})})]}):g.map(e=>(0,r.jsx)(c.E.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"p-4 rounded-lg border cursor-pointer transition-all duration-200 ".concat((null==f?void 0:f.id)===e.id?"border-transparent ring-2 ring-heartglow-pink bg-gradient-to-br from-heartglow-pink/10 via-white to-heartglow-violet/10 dark:from-heartglow-pink/40 dark:to-heartglow-violet/40":"bg-white border-gray-200 hover:border-heartglow-pink/80 dark:bg-heartglow-deepgray dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-heartglow-pink"),onClick:()=>handleSelect(e),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium text-gray-900 dark:text-heartglow-offwhite",children:e.name}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.relationship})]}),e.lastContact&&(0,r.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Last contact: ",new Date(e.lastContact).toLocaleDateString()]})]})},e.id))}),(0,r.jsx)("div",{className:"flex justify-end mt-8",children:(0,r.jsx)("button",{onClick:()=>{f&&t({recipient:f})},disabled:!f,className:"inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-heartglow-pink ".concat(f?"bg-heartglow-pink hover:bg-heartglow-pink/90":"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-gray-700 dark:text-gray-400"),children:"Next"})})]})}let h=[{id:"check-in",title:"Check In",description:"A simple message to see how they're doing",icon:"\uD83D\uDC4B",color:"from-blue-400 to-blue-600"},{id:"gratitude",title:"Gratitude",description:"Express appreciation for their presence in your life",icon:"\uD83D\uDE4F",color:"from-heartglow-pink to-heartglow-violet"},{id:"support",title:"Support",description:"Offer help or encouragement during tough times",icon:"\uD83D\uDCAA",color:"from-green-400 to-teal-500"},{id:"celebration",title:"Celebration",description:"Share joy for their achievements or milestones",icon:"\uD83C\uDF89",color:"from-yellow-400 to-orange-500"},{id:"reconnection",title:"Reconnection",description:"Reach out after some time apart",icon:"\uD83E\uDD1D",color:"from-purple-400 to-indigo-500"},{id:"custom",title:"Custom",description:"Write your own message with a specific purpose",icon:"✍️",color:"from-gray-400 to-gray-600"}];function IntentStep(e){let{onNext:t,onBack:a,initialData:o}=e,[i,s]=(0,n.useState)((null==o?void 0:o.type)||null),[l,d]=(0,n.useState)((null==o?void 0:o.type)==="custom"&&o.custom||""),[g,u]=(0,n.useState)((null==o?void 0:o.type)==="custom");(0,n.useEffect)(()=>{if(o){s(o.type);let e="custom"===o.type;u(e),e&&d(o.custom||"")}else s(null),d(""),u(!1)},[o]);let handleSelect=e=>{s(e),u("custom"===e)};return(0,r.jsxs)("div",{className:"space-y-8 dark:text-heartglow-offwhite",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"What's the purpose of your message?"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Select the intent that best matches your goal"})]}),(0,r.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:h.map(e=>(0,r.jsx)(c.E.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"p-4 rounded-lg border cursor-pointer transition-all duration-200 ".concat(i===e.id?"border-transparent ring-2 ring-heartglow-pink bg-gradient-to-br from-heartglow-pink/10 via-white to-heartglow-violet/10 dark:from-heartglow-pink/40 dark:to-heartglow-violet/40":"bg-white border-gray-200 hover:border-heartglow-pink/80 dark:bg-heartglow-deepgray dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-heartglow-pink"),onClick:()=>handleSelect(e.id),children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-12 h-12 rounded-full bg-gradient-to-br ".concat(e.color," text-white text-2xl mr-3 shadow-sm"),children:e.icon}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium text-gray-900 dark:text-heartglow-offwhite",children:e.title}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]})]})},e.id))}),g&&(0,r.jsxs)(c.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mt-6",children:[(0,r.jsx)("label",{htmlFor:"custom-intent",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Describe your custom intent"}),(0,r.jsx)("textarea",{id:"custom-intent",value:l,onChange:e=>d(e.target.value),className:"w-full p-3 border rounded-lg bg-white text-gray-900 border-gray-300 placeholder-gray-400 focus:ring-2 focus:ring-heartglow-pink focus:border-transparent resize-none  dark:bg-heartglow-deepgray dark:text-heartglow-offwhite dark:border-gray-600 dark:placeholder-gray-400",placeholder:"e.g., Invite to an event, ask for a favor...",rows:3,required:g})]}),(0,r.jsxs)("div",{className:"flex justify-between mt-8",children:[(0,r.jsx)("button",{onClick:a,className:"inline-flex items-center justify-center px-6 py-3 border border-gray-300 dark:border-gray-600 text-base font-medium rounded-md shadow-sm text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-offset-gray-800 transition-colors",children:"Back"}),(0,r.jsx)("button",{onClick:()=>{i&&t({intent:{type:i,custom:"custom"===i?l:void 0}})},disabled:!i||g&&!l.trim(),className:"inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-heartglow-pink ".concat(i&&(!g||l.trim())?"bg-heartglow-pink hover:bg-heartglow-pink/90":"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-gray-700 dark:text-gray-400"),children:"Next"})]})]})}var create_FormatStep=e=>{let{onNext:t,onBack:a,initialData:o}=e,[i,s]=(0,n.useState)((null==o?void 0:o.type)||""),[l,d]=(0,n.useState)((null==o?void 0:o.length)||""),[g,u]=(0,n.useState)((null==o?void 0:o.options)||{emailSubject:"",emojiPreference:"moderate",talkingPoints:3,platform:"general"});return(0,n.useEffect)(()=>{o?(s(o.type||""),d(o.length||""),u(o.options||{emailSubject:"",emojiPreference:"moderate",talkingPoints:3,platform:"general"})):(s(""),d(""),u({emailSubject:"",emojiPreference:"moderate",talkingPoints:3,platform:"general"}))},[o]),(0,r.jsxs)("div",{className:"space-y-8 dark:text-heartglow-offwhite",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Choose Format & Length"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Select how your message will be delivered"})]}),(0,r.jsxs)("div",{className:"space-y-8",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-heartglow-offwhite mb-4",children:"Message Format"}),(0,r.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[{id:"text",label:"Text Message",icon:"\uD83D\uDCF1",description:"Simple message for direct delivery"},{id:"email",label:"Email",icon:"\uD83D\uDCE7",description:"Formal message with subject line"},{id:"conversation",label:"In-Person Conversation",icon:"\uD83D\uDCAC",description:"Talking points for face-to-face"},{id:"card",label:"Greeting Card",icon:"\uD83D\uDC8C",description:"Perfect for celebration or gratitude"},{id:"social",label:"Social Media",icon:"\uD83C\uDF10",description:"Public post or direct message"},{id:"letter",label:"Letter",icon:"✉️",description:"Traditional format for deep connection"}].map(e=>(0,r.jsxs)(c.E.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>s(e.id),className:"p-4 rounded-lg border cursor-pointer transition-all duration-200 ".concat(i===e.id?"border-transparent ring-2 ring-heartglow-pink bg-gradient-to-br from-heartglow-pink/10 via-white to-heartglow-violet/10 dark:from-heartglow-pink/40 dark:to-heartglow-violet/40":"bg-white border-gray-200 hover:border-heartglow-pink/80 dark:bg-heartglow-deepgray dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-heartglow-pink"),children:[(0,r.jsxs)("div",{className:"flex items-center mb-2",children:[(0,r.jsx)("span",{className:"text-2xl mr-2",children:e.icon}),(0,r.jsx)("span",{className:"font-medium text-gray-900 dark:text-heartglow-offwhite",children:e.label})]}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]},e.id))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-heartglow-offwhite mb-4",children:"Message Length"}),(0,r.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[{id:"brief",label:"Brief",description:"1-2 sentences",icon:"\uD83D\uDD39"},{id:"standard",label:"Standard",description:"1 paragraph",icon:"\uD83D\uDD38"},{id:"detailed",label:"Detailed",description:"2-3 paragraphs",icon:"\uD83D\uDCDD"},{id:"extended",label:"Extended",description:"Full letter/email",icon:"\uD83D\uDCC4"}].map(e=>(0,r.jsxs)(c.E.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>d(e.id),className:"p-4 rounded-lg border cursor-pointer transition-all duration-200 ".concat(l===e.id?"border-transparent ring-2 ring-heartglow-pink bg-gradient-to-br from-heartglow-pink/10 via-white to-heartglow-violet/10 dark:from-heartglow-pink/40 dark:to-heartglow-violet/40":"bg-white border-gray-200 hover:border-heartglow-pink/80 dark:bg-heartglow-deepgray dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-heartglow-pink"),children:[(0,r.jsx)("div",{className:"flex items-center justify-center mb-2",children:(0,r.jsx)("span",{className:"text-xl",children:e.icon})}),(0,r.jsx)("h4",{className:"font-medium text-center text-gray-900 dark:text-heartglow-offwhite",children:e.label}),(0,r.jsx)("p",{className:"text-sm text-center text-gray-600 dark:text-gray-400",children:e.description})]},e.id))})]}),i&&(()=>{switch(i){case"email":return(0,r.jsxs)(c.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200 dark:bg-heartglow-deepgray dark:border-gray-600",children:[(0,r.jsx)("label",{htmlFor:"email-subject",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Subject"}),(0,r.jsx)("input",{id:"email-subject",type:"text",value:g.emailSubject,onChange:e=>u(t=>({...t,emailSubject:e.target.value})),className:"w-full p-3 border rounded-lg bg-white text-gray-900 border-gray-300 placeholder-gray-400 focus:ring-2 focus:ring-heartglow-pink focus:border-transparent dark:bg-heartglow-deepgray dark:text-heartglow-offwhite dark:border-gray-600 dark:placeholder-gray-400",placeholder:"Enter email subject"})]});case"text":return(0,r.jsxs)(c.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200 dark:bg-heartglow-deepgray dark:border-gray-600",children:[(0,r.jsx)("label",{htmlFor:"emoji-usage",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Emoji Usage"}),(0,r.jsxs)("select",{id:"emoji-usage",value:g.emojiPreference,onChange:e=>u(t=>({...t,emojiPreference:e.target.value})),className:"w-full p-3 border rounded-lg bg-white text-gray-900 border-gray-300 focus:ring-2 focus:ring-heartglow-pink focus:border-transparent dark:bg-heartglow-deepgray dark:text-heartglow-offwhite dark:border-gray-600",children:[(0,r.jsx)("option",{value:"none",children:"No emojis"}),(0,r.jsx)("option",{value:"minimal",children:"Minimal emojis"}),(0,r.jsx)("option",{value:"moderate",children:"Moderate emojis"}),(0,r.jsx)("option",{value:"frequent",children:"Frequent emojis"})]})]});case"conversation":return(0,r.jsxs)(c.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200 dark:bg-heartglow-deepgray dark:border-gray-600",children:[(0,r.jsx)("label",{htmlFor:"talking-points",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Number of Talking Points"}),(0,r.jsx)("input",{id:"talking-points",type:"number",min:"1",max:"10",value:g.talkingPoints,onChange:e=>u(t=>({...t,talkingPoints:parseInt(e.target.value,10)||1})),className:"w-full p-3 border rounded-lg bg-white text-gray-900 border-gray-300 placeholder-gray-400 focus:ring-2 focus:ring-heartglow-pink focus:border-transparent dark:bg-heartglow-deepgray dark:text-heartglow-offwhite dark:border-gray-600 dark:placeholder-gray-400"})]});case"social":return(0,r.jsxs)(c.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-6 p-4 bg-gray-50 rounded-lg border border-gray-200 dark:bg-heartglow-deepgray dark:border-gray-600",children:[(0,r.jsx)("label",{htmlFor:"platform",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Platform"}),(0,r.jsxs)("select",{id:"platform",value:g.platform,onChange:e=>u(t=>({...t,platform:e.target.value})),className:"w-full p-3 border rounded-lg bg-white text-gray-900 border-gray-300 focus:ring-2 focus:ring-heartglow-pink focus:border-transparent dark:bg-heartglow-deepgray dark:text-heartglow-offwhite dark:border-gray-600",children:[(0,r.jsx)("option",{value:"general",children:"General"}),(0,r.jsx)("option",{value:"twitter",children:"Twitter"}),(0,r.jsx)("option",{value:"instagram",children:"Instagram"}),(0,r.jsx)("option",{value:"facebook",children:"Facebook"}),(0,r.jsx)("option",{value:"linkedin",children:"LinkedIn"})]})]});default:return null}})()]}),(0,r.jsxs)("div",{className:"flex justify-between mt-8",children:[(0,r.jsx)("button",{onClick:a,className:"inline-flex items-center justify-center px-6 py-3 border border-gray-300 dark:border-gray-600 text-base font-medium rounded-md shadow-sm text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-offset-gray-800 transition-colors",children:"Back"}),(0,r.jsx)("button",{onClick:()=>{t({format:{type:i,length:l,options:g}})},disabled:!i||!l,className:"inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-heartglow-pink ".concat(i&&l?"bg-heartglow-pink hover:bg-heartglow-pink/90":"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-gray-700 dark:text-gray-400"),children:"Next"})]})]})};let m=[{id:"warm",label:"Warm",description:"Friendly and affectionate"},{id:"casual",label:"Casual",description:"Relaxed and informal"},{id:"sincere",label:"Sincere",description:"Honest and heartfelt"},{id:"playful",label:"Playful",description:"Light and fun"},{id:"formal",label:"Formal",description:"Professional and respectful"},{id:"reflective",label:"Reflective",description:"Thoughtful and introspective"},{id:"custom",label:"Custom",description:"Define your own tone"}];var create_ToneStep=e=>{let{onNext:t,onBack:a,initialData:o}=e,isStandardTone=e=>!!e&&m.some(t=>t.id===e&&"custom"!==t.id),i=!!o&&!isStandardTone(o),[s,l]=(0,n.useState)(i?"custom":o||null),[d,g]=(0,n.useState)(i&&o||""),[u,h]=(0,n.useState)(i);return(0,n.useEffect)(()=>{let e=!!o&&!isStandardTone(o);l(e?"custom":o||null),h(e),g(e&&o||"")},[o]),(0,r.jsxs)("div",{className:"space-y-8 dark:text-heartglow-offwhite",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"What tone would you like to use?"}),(0,r.jsx)("p",{className:"mt-2 text-sm text-gray-600 dark:text-gray-400",children:"Select the tone that best fits your message"})]}),(0,r.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:m.map(e=>(0,r.jsx)(c.E.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{l(e.id),h("custom"===e.id),"custom"!==e.id&&g("")},className:"p-4 rounded-lg border cursor-pointer transition-all duration-200 ".concat(s===e.id?"border-transparent ring-2 ring-heartglow-pink bg-gradient-to-br from-heartglow-pink/10 via-white to-heartglow-violet/10 dark:from-heartglow-pink/40 dark:to-heartglow-violet/40":"bg-white border-gray-200 hover:border-heartglow-pink/80 dark:bg-heartglow-deepgray dark:border-gray-600 dark:hover:bg-gray-700 dark:hover:border-heartglow-pink"),children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium text-gray-900 dark:text-heartglow-offwhite",children:e.label}),(0,r.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]})},e.id))}),u&&(0,r.jsxs)(c.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mt-6",children:[(0,r.jsx)("label",{htmlFor:"custom-tone",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Describe your desired tone"}),(0,r.jsx)("input",{id:"custom-tone",type:"text",value:d,onChange:e=>g(e.target.value),className:"w-full p-3 border rounded-lg bg-white text-gray-900 border-gray-300 placeholder-gray-400 focus:ring-2 focus:ring-heartglow-pink focus:border-transparent  dark:bg-heartglow-deepgray dark:text-heartglow-offwhite dark:border-gray-600 dark:placeholder-gray-400",placeholder:"e.g., Encouraging, Empathetic...",required:u})]}),(0,r.jsxs)("div",{className:"flex justify-between mt-8",children:[(0,r.jsx)("button",{onClick:a,className:"inline-flex items-center justify-center px-6 py-3 border border-gray-300 dark:border-gray-600 text-base font-medium rounded-md shadow-sm text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-offset-gray-800 transition-colors",children:"Back"}),(0,r.jsx)("button",{onClick:()=>{let e="";s&&(e=u?d.trim():s),e&&t({tone:e})},disabled:!s||u&&!d.trim(),className:"inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-heartglow-pink ".concat(s&&(!u||d.trim())?"bg-heartglow-pink hover:bg-heartglow-pink/90":"bg-gray-300 text-gray-500 cursor-not-allowed dark:bg-gray-700 dark:text-gray-400"),children:"Next"})]})]})};function AdvancedStep(e){let{onNext:t,onBack:a,initialData:o}=e,[i,s]=(0,n.useState)((null==o?void 0:o.intensity)||3),[l,c]=(0,n.useState)((null==o?void 0:o.customInstructions)||"");return(0,n.useEffect)(()=>{o?(s(o.intensity||3),c(o.customInstructions||"")):(s(3),c(""))},[o]),(0,r.jsxs)("div",{className:"space-y-8 dark:text-heartglow-offwhite",children:[(0,r.jsx)("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white text-center",children:"Advanced Options"}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"intensity-slider",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Message Intensity (1-5)"}),(0,r.jsx)("input",{id:"intensity-slider",type:"range",min:"1",max:"5",value:i,onChange:e=>s(Number(e.target.value)),className:"w-full h-2 bg-gray-300 rounded-lg appearance-none cursor-pointer dark:bg-gray-700 accent-heartglow-pink"}),(0,r.jsxs)("div",{className:"flex justify-between text-xs text-gray-600 dark:text-gray-400 mt-1",children:[(0,r.jsx)("span",{children:"Subtle"}),(0,r.jsx)("span",{children:"Balanced"}),(0,r.jsx)("span",{children:"Intense"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{htmlFor:"custom-instructions",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Custom Instructions (Optional)"}),(0,r.jsx)("textarea",{id:"custom-instructions",value:l,onChange:e=>c(e.target.value),className:"w-full p-3 border rounded-lg bg-white text-gray-900 border-gray-300 placeholder-gray-400 focus:ring-2 focus:ring-heartglow-pink focus:border-transparent resize-none dark:bg-heartglow-deepgray dark:text-heartglow-offwhite dark:border-gray-600 dark:placeholder-gray-400",rows:4,placeholder:"e.g., Mention our upcoming trip, Keep it under 50 words..."})]})]}),(0,r.jsxs)("div",{className:"flex justify-between mt-8",children:[(0,r.jsx)("button",{onClick:a,className:"inline-flex items-center justify-center px-6 py-3 border border-gray-300 dark:border-gray-600 text-base font-medium rounded-md shadow-sm text-gray-700 dark:text-gray-300 bg-white dark:bg-gray-700 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-offset-gray-800 transition-colors",children:"Back"}),(0,r.jsx)("button",{onClick:()=>{t({advanced:{intensity:i,customInstructions:l.trim()||null}})},className:"inline-flex items-center justify-center px-6 py-3 border border-transparent text-base font-medium rounded-md shadow-sm text-white bg-heartglow-pink hover:bg-heartglow-pink/90 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-heartglow-pink",children:"Next"})]})]})}var p=a(7004);function extractInsights(e,t){let{intent:a,tone:r,recipient:n}=t,o=["This message maintains a ".concat(r," tone that creates an authentic connection"),"The personalized content acknowledges your relationship as ".concat(n.relationship),"The language is emotionally intelligent and considerate"],i=[];switch(a.type){case"gratitude":i=["Expressing appreciation in a specific way makes the message feel genuine","This acknowledges their impact without creating obligation","The message balances warmth with respect for boundaries"];break;case"support":i=["Offering support without presuming to know exactly what they need","The message conveys presence without demanding a response","The tone provides comfort while respecting their agency"];break;case"celebration":i=["Recognizing their achievement with specific praise feels meaningful","The message focuses on their qualities rather than just outcomes","The tone balances excitement with sincerity"];break;case"reconnection":i=["Opening with warmth helps bridge the gap in communication","Acknowledging the time apart without dwelling on it creates safety","The message offers a path forward without pressure"];break;case"check-in":i=["The casual tone makes responding feel optional, not obligatory","Showing interest without prying creates emotional safety","Offering specific ways to connect makes following up easier"];break;default:i=["The message clearly communicates your intention in a thoughtful way","The tone matches the purpose while maintaining emotional intelligence","The content is focused and specific rather than generic"]}return[...i,...o].slice(0,3)}function generateMockMessage(e){let{recipient:t,intent:a,tone:r,format:n}=e,o={warm:["Dear ".concat(t.name),"My dear ".concat(t.name),"Dearest ".concat(t.name,",")],casual:["Hey ".concat(t.name),"Hi ".concat(t.name),"Hello there ".concat(t.name,",")],sincere:["".concat(t.name,","),"Dear ".concat(t.name,","),"My ".concat(t.relationship," ").concat(t.name,",")],playful:["Hey you!","".concat(t.name,"! \uD83D\uDE0A"),"Heya ".concat(t.name,"!")],formal:["Dear ".concat(t.name,","),"".concat(t.name,","),"Respected ".concat(t.name,",")],reflective:["".concat(t.name,","),"Dear ".concat(t.name,","),"My ".concat(t.relationship," ").concat(t.name,",")]},i={"check-in":["I've been thinking about you lately and wanted to see how you're doing. It's been a while since we caught up, and I'd love to hear what's been happening in your life.","Just wanted to reach out and check how things are going with you. I've been reflecting on our relationship as ".concat(t.relationship,", and thought I'd send a quick message."),"Life gets busy sometimes, but I wanted to take a moment to connect and see how you're doing. I value having you as my ".concat(t.relationship,", and I'd love to hear your updates.")],gratitude:["I wanted to take a moment to express my gratitude for having you in my life. As my ".concat(t.relationship,", you bring so much joy and meaning to my days. I appreciate all that you do and who you are."),"I've been reflecting lately on the people who make a difference in my life, and you immediately came to mind. I'm truly grateful for your presence and the way you ".concat(getRelationshipAttribute(t.relationship),"."),"Sometimes we don't say it enough, but I wanted you to know how thankful I am for you. Your ".concat(getRelationshipAttribute(t.relationship)," means more to me than you might realize.")],support:["I wanted to reach out and let you know that I'm here for you. Whatever you're going through right now, please remember that you don't have to face it alone. As your ".concat(t.relationship,", I'm ready to listen, help, or simply be present in whatever way you need."),"I've been thinking about you and wanted to remind you that you have my unwavering support. Life has its challenges, but you have the strength to overcome them, and I'll be right beside you along the way.","Just a note to say I'm in your corner. We all need support sometimes, and I want you to know that as your ".concat(t.relationship,", I'm here for you - whether you need practical help, a listening ear, or just someone to remind you of how capable you are.")],celebration:["I wanted to celebrate your recent achievement with you! What you've accomplished is truly impressive, and I'm so proud to be your ".concat(t.relationship,". Your hard work, talent, and perseverance have paid off beautifully."),"Congratulations on your success! It's been wonderful to witness your journey, and this achievement is so well-deserved. As your ".concat(t.relationship,", I couldn't be happier for you."),"I'm absolutely thrilled about your recent news! This achievement is a testament to your dedication and abilities. I'm honored to be your ".concat(t.relationship," and to celebrate this special moment with you.")],reconnection:["It's been too long since we connected, and I've been thinking about you. I value our relationship as ".concat(t.relationship,"s, and I'd love to bridge this gap and reconnect. How have you been?"),"I've been reflecting on important relationships in my life, and you came to mind immediately. It's been a while since we've been in touch, and I miss having you as part of my life. I'd love to hear how you've been.","Time has a way of slipping by, but some connections are worth rekindling. I've been thinking about our relationship as ".concat(t.relationship,"s, and I'd like to reach out and reconnect. Would you be open to catching up?")]},s={warm:["With love,","Warmly,","With affection,"],casual:["Talk soon,","Cheers,","See you around,"],sincere:["Sincerely,","With gratitude,","Truly yours,"],playful:["Until next time!","Catch you later!","With a smile,"],formal:["Respectfully,","Kind regards,","Best regards,"],reflective:["In appreciation,","With thought,","Contemplatively,"]},l="sincere",c=o[r]||o[l],d=s[r]||s[l],g=a.type in i?a.type:"gratitude",u=i[g],h=c[Math.floor(Math.random()*c.length)],m=u[Math.floor(Math.random()*u.length)],p=d[Math.floor(Math.random()*d.length)],f=function(e,t){let a=["I hope this message finds you well.","I've been thinking about our relationship as ".concat(t,"s lately."),"Something prompted me to reach out to you today.","I wanted to take a moment to connect with you."];return a[Math.floor(Math.random()*a.length)]}(0,t.relationship),y=function(e,t){let a={gratitude:["Thank you again for being you.","I'm so grateful for your presence in my life.","Your impact on my life deserves recognition."],support:["Remember, I'm here whenever you need me.","Please don't hesitate to reach out if you need anything.","I believe in your strength, but I'm here to support you too."],celebration:["Here's to your continued success!","I look forward to celebrating more of your achievements.","You should be incredibly proud of yourself."],reconnection:["I'd love to hear from you when you have time.","Perhaps we could catch up properly sometime soon?","I hope we can reconnect and rebuild our relationship."],"check-in":["Looking forward to hearing how you've been.","I'd love to catch up properly when you have time.","No pressure to respond immediately, but I'd love to hear from you."]}[t]||["Looking forward to connecting with you again soon.","Wishing you well in all things.","Until next time, take care of yourself."];return a[Math.floor(Math.random()*a.length)]}(0,a.type);return"email"===n.type?"\nSubject: ".concat(function(e,t){let a={gratitude:["A note of thanks","Gratitude for you, ".concat(t),"Appreciating our connection"],support:["Thinking of you","Here for you","Support and encouragement"],celebration:["Celebrating your success!","Congratulations!","In recognition of your achievement"],reconnection:["Reconnecting","Reaching out","Let's catch up"],"check-in":["Checking in","How have you been?","Just saying hello"]}[e]||["A message for ".concat(t),"Reaching out","Connecting with you"];return a[Math.floor(Math.random()*a.length)]}(a.type,t.name),"\n\n").concat(h,"\n\n").concat(f,"\n\n").concat(m,"\n\n").concat(y,"\n\n").concat(p,"\n").trim():"\n".concat(h,"\n\n").concat(m,"\n\n").concat(y,"\n\n").concat(p,"\n").trim()}function getRelationshipAttribute(e){let t=e.toLowerCase(),a={friend:["friendship","loyalty","understanding","shared laughter"],partner:["love","companionship","support","partnership"],family:["love","support","understanding","presence"],colleague:["collaboration","professionalism","support","insights"],mentor:["guidance","wisdom","support","belief in me"],mentee:["eagerness to learn","fresh perspective","growth","questions that make me think"],acquaintance:["occasional conversations","perspectives","connection","presence"]}[t]||["presence in my life","unique perspective","role in my life"];return a[Math.floor(Math.random()*a.length)]}async function generateMessage(e){try{let t=function(e){let{recipient:t,intent:a,format:r,tone:n,advanced:o}=e,i="Create a ".concat(r.length," message for ").concat(t.name," (").concat(t.relationship,").\n\n");return i+="Intent: ".concat(a.custom||a.type,"\n")+"Tone: ".concat(n,"\n")+"Format: ".concat(r.type,"\n"),(null==o?void 0:o.intensity)&&(i+="Intensity level: ".concat(o.intensity,"/5\n")),(null==o?void 0:o.customInstructions)&&(i+="Additional instructions: ".concat(o.customInstructions,"\n")),i+="\nPlease generate a thoughtful, personalized message that feels authentic and appropriate for this relationship."}(e);console.log("Generating message with prompt:",t);let a=(0,p.$C)(s.l2),r=(0,p.V1)(a,"generateMessageV2"),n=await r({params:e,prompt:t}),o=n.data;if(o&&o.content)return{content:o.content,insights:o.insights||extractInsights(o.content,e)};console.warn("Cloud function returned invalid data, falling back to mock generator");let i=generateMockMessage(e),l=extractInsights(i,e);return{content:i,insights:l}}catch(r){console.error("Error generating message:",r),console.warn("Error calling cloud function, falling back to mock generator");let t=generateMockMessage(e),a=extractInsights(t,e);return{content:t,insights:a}}}async function openai_generateMessage(e){try{return generateMessage(e)}catch(e){throw console.error("Error generating message:",e),e}}async function openai_generateMessageDirect(e){try{return generateMessage(e)}catch(e){return console.error("Error in direct message generation:",e),{content:"Unable to generate a message at this time. Please try again later.",insights:[]}}}var f=a(1798),y=a(116),x=a(3742),b=a(6915),w=a(9589),k=a(2552),v=a(3219),j=a(3278);function MessageOutput(e){let{recipient:t,intent:a,format:d,tone:g,advanced:h}=e,[m,p]=(0,n.useState)(!0),[N,C]=(0,n.useState)(!1),[I,S]=(0,n.useState)(""),[D,M]=(0,n.useState)([]),[E,T]=(0,n.useState)(null),{currentUser:F,userProfile:A}=(0,i.a)(),{challenges:P}=(0,j.B)(),[R,B]=(0,n.useState)(!0),W=(0,o.useRouter)(),_=null==A?void 0:A.activeChallenge,O=_?P.find(e=>e.id===_.challengeId):null,autoSaveMessage=async(e,r)=>{if(!F){console.warn("[autoSaveMessage] No user logged in, cannot save message.");return}if(!e){console.warn("[autoSaveMessage] No message content generated, cannot save.");return}console.log("[autoSaveMessage] Attempting to save message for user:",F.uid);try{let n={content:e,recipientName:t.name,recipientId:t.id||null,relationship:t.relationship,intent:a.type,tone:g,intensity:(null==h?void 0:h.intensity)||3,createdAt:(0,l.Bt)(),insights:r,messageCategory:a.type,messageFormat:d.type,messageIntention:a.custom||a.type,messageConfigTimestamp:new Date().toISOString(),appliedToChallenge:!!_&&R};console.log("[autoSaveMessage] Saving data:",n);let o=(0,l.hJ)(s.db,"users",F.uid,"messages"),i=await (0,l.ET)(o,n);console.log("[autoSaveMessage] Message auto-saved successfully with ID:",i.id);let c=(0,l.JU)(s.db,"users",F.uid);await (0,l.r7)(c,{totalMessageCount:(0,l.nP)(1)}),console.log("[autoSaveMessage] Incremented user totalMessageCount."),t.id?await (0,f.Qf)(F,t.id):console.warn("[autoSaveMessage] No recipient.id found, cannot update connection message count.")}catch(e){console.error("[autoSaveMessage] Error auto-saving message or updating counts:",e)}};(0,n.useEffect)(()=>{let generateAndSave=async()=>{let e="",r=[];try{let n;p(!0),T(null);let o={recipient:{name:t.name,relationship:t.relationship},intent:a,format:d,tone:g,advanced:h};try{console.log("[generateAndSave] Calling generateMessage cloud function..."),n=await openai_generateMessage(o),console.log("[generateAndSave] Cloud function result:",n)}catch(e){console.warn("[generateAndSave] Cloud function failed, falling back to direct OpenAI:",e),n=await openai_generateMessageDirect(o),console.log("[generateAndSave] Direct OpenAI result:",n)}if(n&&n.content)e=n.content,r=n.insights||[],S(e),M(r);else throw Error("Invalid response from generation function")}catch(e){console.error("Error generating message:",e),T("Failed to generate message. Please try again.")}finally{p(!1)}};generateAndSave()},[t,a,d,g,h]);let handleConfirmSave=async()=>{if(!I){console.error("No message content to save.");return}if(console.log("handleConfirmSave triggered. applyToChallenge state:",R),await autoSaveMessage(I,D),R&&_){var e,t,a,r;let n=P.find(e=>e.id===_.challengeId),o=null!==(a=null!==(t=null==n?void 0:null===(e=n.criteria)||void 0===e?void 0:e.value)&&void 0!==t?t:_.goal)&&void 0!==a?a:1,i=null!==(r=_.progress)&&void 0!==r?r:0;i+1>=Number(o)&&(console.log("[handleConfirmSave] Challenge appears completed. Setting sessionStorage flag."),sessionStorage.setItem("challengeCompleted","true"))}handleCopyToClipboard(I),W.push("/")},handleCopyToClipboard=e=>{navigator.clipboard.writeText(e).then(()=>{C(!0),setTimeout(()=>C(!1),2e3)}).catch(e=>{console.error("Failed to copy:",e)})};return m?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center text-center py-20 max-w-md mx-auto",children:[(0,r.jsx)(c.E.div,{animate:{rotate:360},transition:{duration:1,repeat:1/0,ease:"linear"},className:"w-16 h-16 mb-6 rounded-full border-4 border-gray-600 border-t-heartglow-pink"}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-300 mb-2",children:"Crafting your heartfelt message..."}),(0,r.jsx)("p",{className:"text-gray-400",children:"This may take just a moment."})]}):E?(0,r.jsxs)("div",{className:"text-center py-12 max-w-md mx-auto bg-gray-800/50 border border-red-500/30 rounded-xl p-8",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-red-900/30 text-red-400 rounded-full flex items-center justify-center mx-auto mb-5",children:(0,r.jsx)(y.Z,{size:32})}),(0,r.jsx)("h3",{className:"text-xl font-semibold text-red-400 mb-3",children:E}),(0,r.jsx)("button",{onClick:()=>window.location.reload(),className:"mt-4 inline-flex items-center justify-center bg-gray-600 hover:bg-gray-500 text-gray-100 font-medium rounded-lg px-6 py-2.5 transition-colors",children:"Try Again"})]}):(0,r.jsxs)(c.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,ease:"easeOut"},className:"max-w-3xl mx-auto py-8 md:py-12 space-y-8",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)(c.E.h2,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.1},className:"text-3xl md:text-4xl font-bold bg-gradient-to-r from-heartglow-pink to-heartglow-violet text-transparent bg-clip-text mb-2",children:"Your Message Is Ready"}),(0,r.jsxs)(c.E.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.2},className:"mt-2 text-lg text-gray-400",children:["Crafted for ",t.name," with ","email"===d.type?"an email":"a message"," that conveys ",a.type]})]}),(0,r.jsxs)(c.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-gradient-to-br from-gray-800 to-gray-900 p-6 md:p-8 rounded-xl shadow-lg border border-gray-700/80",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-5",children:[(0,r.jsxs)("h3",{className:"text-xl font-semibold text-white",children:["Message for ",t.name]}),(0,r.jsxs)("button",{onClick:()=>handleCopyToClipboard(I),className:"text-sm px-3 py-1.5 rounded-full transition-all duration-200 flex items-center focus:outline-none focus:ring-2 focus:ring-heartglow-pink focus:ring-offset-2 focus:ring-offset-gray-900 ".concat(N?"bg-green-600/80 text-white":"bg-gray-700 hover:bg-gray-600 text-gray-300"),"aria-label":N?"Copied!":"Copy message",children:[N?(0,r.jsx)(x.Z,{size:16,className:"mr-1.5"}):(0,r.jsx)(b.Z,{size:16,className:"mr-1.5"}),N?"Copied!":"Copy"]})]}),(0,r.jsx)("div",{className:"bg-gray-900/50 p-5 rounded-lg border border-gray-700 min-h-[150px]",children:(0,r.jsx)("p",{className:"whitespace-pre-wrap text-gray-200 text-base md:text-lg leading-relaxed",children:I})})]}),D.length>0&&(0,r.jsxs)(c.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-gradient-to-br from-gray-800 to-gray-900 p-6 md:p-8 rounded-xl shadow-lg border border-gray-700/80",children:[(0,r.jsx)("h3",{className:"text-xl font-semibold mb-5 text-white",children:"Why This Message Works"}),(0,r.jsx)("ul",{className:"space-y-4",children:D.map((e,t)=>(0,r.jsxs)(c.E.li,{initial:{opacity:0,x:-15},animate:{opacity:1,x:0},transition:{delay:.5+.1*t},className:"flex items-start text-gray-300 text-base",children:[(0,r.jsx)(w.Z,{size:20,className:"w-5 h-5 mr-3 mt-1 text-heartglow-pink flex-shrink-0"}),(0,r.jsx)("span",{children:e})]},t))})]}),_&&O&&(0,r.jsxs)(c.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.45},className:"flex items-center justify-center my-6 p-4 bg-gray-800/60 border border-gray-700 rounded-lg",children:[(0,r.jsx)("input",{type:"checkbox",id:"applyChallengeCheckbox",checked:R,onChange:e=>B(e.target.checked),className:"w-5 h-5 rounded text-heartglow-pink bg-gray-700 border-gray-600 focus:ring-heartglow-pink dark:focus:ring-offset-gray-800"}),(0,r.jsxs)("label",{htmlFor:"applyChallengeCheckbox",className:"ml-3 text-sm font-medium text-gray-300",children:["Count this message towards the challenge: ",(0,r.jsx)("span",{className:"font-semibold text-indigo-300",children:O.name})]})]}),(0,r.jsxs)(c.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5+.1*D.length},className:"flex flex-col sm:flex-row items-center justify-between gap-4 pt-6 border-t border-gray-700/50 mt-8",children:[(0,r.jsxs)("button",{onClick:handleConfirmSave,className:"w-full sm:w-auto inline-flex items-center justify-center px-6 py-3 rounded-lg text-base font-semibold transition-all duration-300 ease-in-out transform hover:scale-105 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-heartglow-pink dark:focus:ring-offset-gray-900 shadow-md hover:shadow-lg bg-gradient-to-r from-heartglow-pink to-heartglow-violet text-white hover:from-heartglow-pink/90 hover:to-heartglow-violet/90'}",children:[(0,r.jsx)(k.Z,{size:20,className:"mr-2"})," ","Save & Copy Message"]}),(0,r.jsxs)(u(),{href:"/",className:"inline-flex items-center text-sm font-medium text-gray-400 hover:text-white transition-colors",children:[(0,r.jsx)(v.Z,{size:16,className:"mr-1.5"}),"Return to Dashboard"]})]})]})}var N=a(1526);let C=[{number:1,label:"Recipient"},{number:2,label:"Intent"},{number:3,label:"Format"},{number:4,label:"Tone"},{number:5,label:"Refine"}];function CreatePage(){console.log(">>> CreatePage component rendering started");let e=(0,o.useRouter)(),{currentUser:t,loading:a}=(0,i.a)(),[s,l]=(0,n.useState)(1),[d,g]=(0,n.useState)({recipient:null,intent:null,format:null,tone:null,advanced:null});if((0,n.useEffect)(()=>{if(e.isReady){let{intent:t,tone:a}=e.query;(t||a)&&(console.log(">>> Query params found:",{queryIntent:t,queryTone:a}),g(e=>({...e,intent:t?{type:t,custom:""}:e.intent,tone:a||e.tone})))}},[e.isReady,e.query]),a)return(0,r.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-heartglow-pink"})});if(!t)return e.push("/login"),null;let handleNext=e=>{g(t=>({...t,...e})),l(e=>e+1)},handleBack=()=>{l(e=>e-1)};return(0,r.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-gray-50 to-gray-100 dark:from-heartglow-deepgray dark:to-gray-900 py-16 md:py-24",children:(0,r.jsx)("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)(c.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:"bg-white dark:bg-heartglow-deepgray text-gray-900 dark:text-gray-100 rounded-xl shadow-xl overflow-hidden p-8 sm:p-10",children:[s<=5&&(0,r.jsx)("div",{className:"mb-10 sm:mb-12",children:(0,r.jsx)("div",{className:"flex items-start justify-between",children:C.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center flex-grow justify-center flex-col sm:flex-row",children:[(0,r.jsxs)("div",{className:"flex flex-col items-center text-center",children:[(0,r.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center font-bold text-lg mb-1 transition-all duration-300 ".concat(e.number<s?"bg-heartglow-pink text-white shadow-md":e.number===s?"bg-heartglow-violet text-white scale-110 shadow-lg":"bg-gray-200 dark:bg-gray-600 text-gray-500 dark:text-gray-400"),children:e.number}),(0,r.jsx)("span",{className:"text-xs sm:text-sm font-medium transition-colors duration-300 ".concat(e.number<=s?"text-heartglow-charcoal dark:text-heartglow-offwhite":"text-gray-400 dark:text-gray-500"),children:e.label})]}),t<C.length-1&&(0,r.jsx)("div",{className:"h-1 flex-grow mx-2 mt-5 hidden sm:block transition-colors duration-300 ".concat(e.number<s?"bg-heartglow-pink":"bg-gray-200 dark:bg-gray-600")})]},e.number))})}),(console.log(">>> CreatePage rendering step: ".concat(s)),(0,r.jsx)(N.M,{mode:"wait",children:(0,r.jsx)(c.E.div,{variants:{initial:{opacity:0,x:50},animate:{opacity:1,x:0},exit:{opacity:0,x:-50}},initial:"initial",animate:"animate",exit:"exit",transition:{duration:.3,ease:"easeInOut"},children:(()=>{switch(s){case 1:return(0,r.jsx)(RecipientStep,{onNext:handleNext,initialData:d.recipient});case 2:return(0,r.jsx)(IntentStep,{onNext:handleNext,onBack:handleBack,initialData:d.intent});case 3:return(0,r.jsx)(create_FormatStep,{onNext:handleNext,onBack:handleBack,initialData:d.format});case 4:return(0,r.jsx)(create_ToneStep,{onNext:handleNext,onBack:handleBack,initialData:d.tone});case 5:return(0,r.jsx)(AdvancedStep,{onNext:handleNext,onBack:handleBack,initialData:d.advanced});case 6:return(0,r.jsx)(MessageOutput,{recipient:d.recipient,intent:d.intent,format:d.format,tone:d.tone,advanced:d.advanced});default:return null}})()},s)}))]})})})}}},function(e){e.O(0,[424,495,887,4,32,774,888,179],function(){return e(e.s=7532)}),_N_E=e.O()}]);