(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[307],{3857:function(e,r,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/account/link",function(){return a(705)}])},705:function(e,r,a){"use strict";a.r(r);var t=a(5893),o=a(7294),s=a(1503),n=a(1163),l=a(9008),i=a.n(l),c=a(9451),d=a(34);r.default=()=>{let{currentUser:e}=(0,s.a)(),r=(0,n.useRouter)(),[a,l]=o.useState(""),[u,g]=o.useState(""),[m,h]=o.useState(null),[y,f]=o.useState(!1),[x,p]=o.useState(!1);o.useEffect(()=>{e&&!e.isAnonymous&&(console.log("User is already permanent, redirecting from link page..."),r.replace("/"))},[e,r]);let handleLinkWithEmail=async t=>{if(t.preventDefault(),h(null),f(!0),!(null==e?void 0:e.isAnonymous)){h("No anonymous user found to link, or user state changed."),f(!1);return}console.log("Attempting to link with Email/Password...");try{let t=c.w9.credential(a,u);await (0,c.ZJ)(e,t),console.log("Email account linked successfully!"),r.push("/")}catch(e){if(console.error("Email linking error:",e),"object"==typeof e&&null!==e&&"code"in e)switch(e.code){case"auth/email-already-in-use":h("This email address is already associated with another account.");break;case"auth/invalid-credential":h("Incorrect email or password. Please try again.");break;case"auth/weak-password":h("Password is too weak. Please choose a stronger password.");break;case"auth/credential-already-in-use":h("This email/password is already linked to your account.");break;default:h("An unexpected error occurred: ".concat(e.message))}else h("An unexpected error occurred during email linking.")}finally{f(!1)}},handleLinkWithGoogle=async()=>{if(h(null),p(!0),!(null==e?void 0:e.isAnonymous)){h("No anonymous user found to link, or user state changed."),p(!1);return}console.log("Attempting to link with Google...");try{let a=new c.hJ,t=await (0,c.rh)(d.I8,a),o=c.hJ.credentialFromResult(t);if(!o)throw Error("Could not get Google credential from result.");await (0,c.ZJ)(e,o),console.log("Google account linked successfully!"),r.push("/")}catch(e){if(console.error("Google linking error:",e),"object"==typeof e&&null!==e&&"code"in e)switch(e.code){case"auth/credential-already-in-use":h("This Google account is already associated with another HeartGlow account or already linked.");break;case"auth/popup-closed-by-user":h("Google sign-in popup closed before completion.");break;case"auth/cancelled-popup-request":h("Multiple popups opened. Please close others and try again.");break;case"auth/unauthorized-domain":h("This domain isn't authorized for Google Sign-In. (Configuration Issue)");break;case"auth/user-mismatch":h("Cannot link credentials for different users.");break;default:h("An unexpected error occurred: ".concat(e.message))}else e instanceof Error?h(e.message):h("An unexpected error occurred during Google linking.")}finally{p(!1)}};return e?e.isAnonymous?(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gray-50 dark:bg-gray-900 p-4",children:[(0,t.jsx)(i(),{children:(0,t.jsx)("title",{children:"Create Account - HeartGlow AI"})}),(0,t.jsxs)("div",{className:"w-full max-w-md p-8 space-y-6 bg-white dark:bg-gray-800 rounded-lg shadow-md",children:[(0,t.jsx)("h1",{className:"text-2xl font-bold text-center text-gray-900 dark:text-white",children:"Create Your HeartGlow Account"}),(0,t.jsx)("p",{className:"text-center text-sm text-gray-600 dark:text-gray-400",children:"Save your connections, messages, and progress permanently by linking your current session to an account."}),m&&(0,t.jsx)("p",{className:"text-red-500 text-sm text-center mb-4",children:m}),(0,t.jsxs)("form",{onSubmit:handleLinkWithEmail,className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Email address"}),(0,t.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:a,onChange:e=>l(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white",placeholder:"you@example.com"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 dark:text-gray-300",children:"Password"}),(0,t.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,value:u,onChange:e=>g(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm placeholder-gray-400 dark:placeholder-gray-500 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm dark:bg-gray-700 dark:text-white",placeholder:"••••••••"})]}),(0,t.jsx)("button",{type:"submit",disabled:y||x,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:y?"Linking Email...":"Create Account with Email"})]}),(0,t.jsxs)("div",{className:"relative my-4",children:[(0,t.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,t.jsx)("div",{className:"w-full border-t border-gray-300 dark:border-gray-600"})}),(0,t.jsx)("div",{className:"relative flex justify-center text-sm",children:(0,t.jsx)("span",{className:"px-2 bg-white dark:bg-gray-800 text-gray-500 dark:text-gray-400",children:"Or continue with"})})]}),(0,t.jsx)("div",{children:(0,t.jsxs)("button",{type:"button",onClick:handleLinkWithGoogle,disabled:y||x,className:"w-full inline-flex justify-center py-2 px-4 border border-gray-300 dark:border-gray-600 rounded-md shadow-sm bg-white dark:bg-gray-700 text-sm font-medium text-gray-700 dark:text-gray-200 hover:bg-gray-50 dark:hover:bg-gray-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 disabled:opacity-50",children:[(0,t.jsxs)("svg",{className:"w-5 h-5 mr-2",fill:"currentColor",viewBox:"0 0 20 20",children:[" ",(0,t.jsx)("path",{fillRule:"evenodd",d:"M10 2C5.03 2 1 6.03 1 11s4.03 9 9 9 9-4.03 9-9-4.03-9-9-9zm5.2 6.88l-1.52.93C13.17 10.6 12.14 11 11 11h-.06c-1.3 0-2.4-.84-2.84-2H10c.4 0 .77-.14.95-.38.18-.24.26-.52.23-.8l-.09-.75c-.03-.28-.14-.55-.34-.75s-.47-.31-.75-.31H8.1c-.66 0-1.2.54-1.2 1.2v.01c0 .66.54 1.2 1.2 1.2H10c.17 0 .33.03.48.09l.02.01c.5.18.9.56 1.12 1.04.23.48.29.98.17 1.46l-.17.68c-.12.48-.4.9-.8 1.2-.4.3-.88.46-1.38.46h-.01c-.66 0-1.2-.54-1.2-1.2 0-.1.01-.19.04-.28l.11-.44c.12-.48.4-.9.8-1.2.4-.3.88-.46 1.38-.46h.16c.34 0 .67.07.97.2l1.52.93c.49.3.49.8 0 1.1l-1.52.93c-.3.18-.63.28-.97.28h-.16c-.96 0-1.84-.45-2.4-1.18-.56-.73-.8-1.66-.64-2.58l.11-.44C7.81 8.84 8.6 8 9.9 8h.16c.96 0 1.84.45 2.4 1.18.56.73.8 1.66.64 2.58l-.11.44c-.03.09-.04.18-.04.28 0 .66-.54 1.2-1.2 1.2h-.01c-.5 0-.98-.16-1.38-.46-.4-.3-.68-.72-.8-1.2l-.17-.68c-.12-.48-.06-.98.17-1.46.22-.48.62-.86 1.12-1.04l.02-.01c.15-.06.31-.09.48-.09H10v-1h-.06c-.5 0-.98.16-1.38.46-.4.3-.68.72-.8 1.2l-.11.44c-.16.92.08 1.85.64 2.58.56.73 1.44 1.18 2.4 1.18h.16c.5 0 .98-.16 1.38-.46.4-.3.68-.72.8-1.2l1.52-.93c.49-.3.49-.8 0-1.1z",clipRule:"evenodd"})," "]}),x?"Linking Google...":"Continue with Google"]})}),(0,t.jsx)("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400",children:"By creating an account, you agree to our Terms of Service and Privacy Policy (links to be added)."})]})]}):(0,t.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:"Redirecting..."}):(0,t.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:"Loading user data..."})}},1163:function(e,r,a){e.exports=a(9974)}},function(e){e.O(0,[774,888,179],function(){return e(e.s=3857)}),_N_E=e.O()}]);