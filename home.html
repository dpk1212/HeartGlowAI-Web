<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HeartGlowAI - Dashboard</title>
  <meta name="description" content="AI-powered heartfelt message generator for all your relationships. Create authentic messages for loved ones.">
  
  <!-- Favicon -->
  <link rel="icon" href="/favicon.ico" sizes="any">
  
  <!-- Resource Hints -->
  <link rel="preconnect" href="https://www.gstatic.com" crossorigin>
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="preload" href="css/main.css" as="style">
  <link rel="preload" href="js/home.js" as="script">
  
  <!-- Google Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  
  <!-- FontAwesome -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/js/all.min.js" integrity="sha512-fD9DI5bZwQxOi7MhYWnnNPlvXdp/2Pj3XSTRrFs5FQa4mizyGLnJcN6tuvUS6LbmgN1ut+XGSABKvjN0H6Aoow==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
  
  <!-- Firebase Scripts -->
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-analytics-compat.js"></script>
  
  <!-- CSS -->
  <link rel="stylesheet" href="css/main.css">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
  
  <script>
    // Initialize Firebase with error handling
    try {
      const firebaseConfig = {
        apiKey: "AIzaSyBZiJPTs7dMccVgFV-YoTejnhy1bZNFEQY",
        authDomain: "heartglowai.firebaseapp.com",
        projectId: "heartglowai",
        storageBucket: "heartglowai.firebasestorage.app",
        messagingSenderId: "196565711798",
        appId: "1:196565711798:web:79e2b0320fd8e74ab0df17",
        measurementId: "G-KJMPL1DNPY"
      };
      
      console.log("Starting Firebase initialization...");
      
      // Initialize Firebase if not already initialized
      if (!window.firebase || !firebase.apps || !firebase.apps.length) {
        firebase.initializeApp(firebaseConfig);
        console.log("Firebase initialized successfully");
      } else {
        console.log("Firebase already initialized");
      }
      
      // Critical: Set persistence to LOCAL for auth
      if (firebase && firebase.auth) {
        firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL)
          .catch(function(error) {
            console.error("Auth persistence error:", error);
            // Continue anyway, not critical
          });
      }
    } catch (e) {
      console.error("Firebase initialization failed:", e);
      // Continue anyway, app will use sample data
    }
  </script>
</head>

<body class="home-page">
  <div class="home-page__container">
    <!-- Header -->
    <header class="home-page__header">
      <a href="#" class="home-page__logo">
        <span class="auth-logo__icon">❤️</span>
        <span class="auth-logo__text">Heart<span class="auth-logo__highlight">GlowAI</span></span>
      </a>
      <div class="home-page__user-menu">
        <div class="profile-menu-container">
          <div class="home-page__user-avatar" id="userInitials" tabindex="0">
            <!-- Will be populated with user initials via JS -->
          </div>
          <div class="profile-dropdown" id="profileDropdown">
            <button id="logout-button" class="dropdown-item logout-button">
              <i class="fas fa-sign-out-alt"></i> Log Out
            </button>
          </div>
        </div>
      </div>
    </header>

    <!-- Welcome section -->
    <section class="home-page__welcome">
      <h1 class="home-page__welcome-title">Welcome to HeartGlowAI</h1>
      <p class="home-page__welcome-subtitle">Create heartfelt messages for your loved ones with our AI-powered assistant.</p>
    </section>

    <!-- New Message Configurator Section -->
    <section class="message-configurator">
      <div class="configurator-inner">
        <!-- Front Face: Category & Format -->
        <div class="configurator-front">
          <h2 class="configurator-title">Start Crafting Your Message</h2>
          
          <!-- Step 1: Category Toggle -->
          <div class="configurator-step">
            <h3 class="step-title">1. Choose Context</h3>
            <div class="category-toggle">
              <button class="toggle-btn active" data-category="professional">💼 Professional</button>
              <button class="toggle-btn" data-category="personal">💖 Personal</button>
            </div>
          </div>
    
          <!-- Step 2: Format Selection -->
          <div class="configurator-step">
            <h3 class="step-title">2. Select Format</h3>
            <div class="format-options">
              <button class="format-btn" data-format="text">📱 Text Message</button>
              <button class="format-btn" data-format="email">📧 Email</button>
              <button class="format-btn" data-format="card">💌 Card</button>
              <button class="format-btn" data-format="conversation">🗣️ Conversation Topics</button>
              <!-- Add more format buttons as needed -->
            </div>
          </div>
        </div> 
        
        <!-- Back Face: Intention & Action -->
        <div class="configurator-back">
          <h2 class="configurator-title">Refine Your Message</h2> 
          
          <!-- Step 3: Intention Selection -->
          <div class="configurator-step">
            <h3 class="step-title">3. Pick Your Starting Point</h3>
            <!-- Professional Intentions (Visible by default) -->
            <div class="intention-options professional-intentions">
              <button class="intention-card" data-intention="recognize_effort">💬 "I want to recognize someone's effort."</button>
              <button class="intention-card" data-intention="give_feedback">🧠 "I need to give feedback — with care."</button>
              <button class="intention-card" data-intention="thank_support">🙏 "I want to thank someone for their support."</button>
              <button class="intention-card" data-intention="express_clearly">🎯 "I need to express something clearly and respectfully."</button>
              <button class="intention-card" data-intention="acknowledge_impact">👏 "Someone deserves to feel seen for their impact."</button>
            </div>
            <!-- Personal Intentions (Hidden by default) -->
            <div class="intention-options personal-intentions" style="display: none;">
              <button class="intention-card" data-intention="thinking_of_you">❤️ "I've been thinking about someone..."</button>
              <button class="intention-card" data-intention="say_thank_you">🙏 "I want to say thank you — properly."</button>
              <button class="intention-card" data-intention="reconnect">🤝 "We haven't talked in a while."</button>
              <button class="intention-card" data-intention="express_feelings">✍️ "I want to say something I've been holding in."</button>
              <button class="intention-card" data-intention="make_smile">💬 "I just want to make someone smile."</button>
            </div>
          </div>
    
          <!-- Step 4: Action Button -->
          <div class="configurator-action">
            <button id="start-crafting-btn" class="start-crafting-button" disabled>
              Select Format & Starting Point
            </button>
          </div>
          
          <!-- Optional: Add a 'Back' button? -->
          <!-- <button id="configurator-back-btn" class="back-button">← Back</button> -->
        </div>
      </div>
    </section>

    <!-- Dashboard layout -->
    <div class="home-page__dashboard">
      <!-- Left column -->
      <div class="home-page__dashboard-left">
        <!-- Recent Messages -->
        <div class="home-page__card">
          <div class="home-page__card-header">
            <h3 class="home-page__card-title">
              <span class="home-page__card-icon"><i class="fas fa-history"></i></span>
              Recent Messages
            </h3>
            <a href="#" class="home-page__card-action" id="view-all-messages">
              View All <span class="home-page__card-action-icon">→</span>
            </a>
          </div>

          <div class="home-page__messages" id="recent-messages-list">
            <!-- Messages will be populated via JS -->
            <!-- Example message card (will be replaced by real content) -->
            <div class="home-page__message-card" data-message-id="example1">
              <div class="home-page__message-header">
                <div class="home-page__message-meta">
                  <div class="home-page__message-type">Romantic</div>
                  <div class="home-page__message-time">25 minutes ago</div>
                </div>
              </div>
              <div class="home-page__message-text">
                "I've been thinking about you lately, and I realized I never properly told you how much your presence means to me. Your laugh, your kindness, the way you see the world - it all brings so much joy into my life."
              </div>
              <div class="home-page__message-actions">
                <button class="home-page__message-button">
                  <i class="far fa-copy"></i> Copy
                </button>
                <button class="home-page__message-button">
                  <i class="far fa-edit"></i> Edit
                </button>
                <button class="home-page__message-button home-page__message-button--primary">
                  <i class="fas fa-share"></i> Share
                </button>
              </div>
            </div>

            <div class="home-page__message-card" data-message-id="example2">
              <div class="home-page__message-header">
                <div class="home-page__message-meta">
                  <div class="home-page__message-type">Professional</div>
                  <div class="home-page__message-time">30 minutes ago</div>
                </div>
              </div>
              <div class="home-page__message-text">
                "Your guidance on the recent project helped us navigate complex challenges with remarkable clarity and purpose. Your leadership created a vision that inspired the entire team to deliver beyond expectations."
              </div>
              <div class="home-page__message-actions">
                <button class="home-page__message-button">
                  <i class="far fa-copy"></i> Copy
                </button>
                <button class="home-page__message-button">
                  <i class="far fa-edit"></i> Edit
                </button>
                <button class="home-page__message-button home-page__message-button--primary">
                  <i class="fas fa-share"></i> Share
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Right column -->
      <div class="home-page__dashboard-right">
        <!-- My Connections -->
        <div class="home-page__card">
          <div class="home-page__card-header">
            <h3 class="home-page__card-title">
              <span class="home-page__card-icon"><i class="fas fa-users"></i></span>
              My Connections
            </h3>
            <a href="#" class="home-page__card-action" id="manage-connections">
              Manage <span class="home-page__card-action-icon">→</span>
            </a>
          </div>

          <div class="home-page__connections" id="connections-list">
            <!-- Connections will be populated via JS -->
            <!-- Example connection (will be replaced by real content) -->
            <div class="home-page__connection" data-connection-id="example1">
              <div class="home-page__connection-info">
                <div class="home-page__connection-avatar">K</div>
                <div class="home-page__connection-details">
                  <div class="home-page__connection-name">Kate</div>
                  <div class="home-page__connection-type">romantic</div>
                </div>
              </div>
              <div class="home-page__connection-actions">
                <button class="home-page__connection-button">
                  <i class="fas fa-paper-plane"></i>
                </button>
                <button class="home-page__connection-button">
                  <i class="fas fa-edit"></i>
                </button>
                <button class="home-page__connection-button">
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </div>

            <div class="home-page__connection" data-connection-id="example2">
              <div class="home-page__connection-info">
                <div class="home-page__connection-avatar">D</div>
                <div class="home-page__connection-details">
                  <div class="home-page__connection-name">Dad</div>
                  <div class="home-page__connection-type">family</div>
                </div>
              </div>
              <div class="home-page__connection-actions">
                <button class="home-page__connection-button">
                  <i class="fas fa-paper-plane"></i>
                </button>
                <button class="home-page__connection-button">
                  <i class="fas fa-edit"></i>
                </button>
                <button class="home-page__connection-button">
                  <i class="fas fa-trash"></i>
                </button>
              </div>
            </div>

            <!-- Add connection button -->
            <button class="home-page__add-connection" id="add-connection-btn">
              <span class="home-page__add-connection-icon"><i class="fas fa-plus"></i></span>
              Add New Connection
            </button>
          </div>
        </div>

        <!-- Upcoming Reminders -->
        <div class="home-page__card">
          <div class="home-page__card-header">
            <h3 class="home-page__card-title">
              <span class="home-page__card-icon"><i class="fas fa-bell"></i></span>
              Upcoming Reminders
            </h3>
            <a href="#" class="home-page__card-action" id="manage-reminders">
              Manage <span class="home-page__card-action-icon">→</span>
            </a>
          </div>

          <div class="home-page__reminders" id="reminders-list">
            <!-- Empty state for reminders -->
            <div class="home-page__empty-state">
              <div class="home-page__empty-state-icon">
                <i class="fas fa-bell-slash"></i>
              </div>
              <div class="home-page__empty-state-text">No upcoming reminders</div>
              <div class="home-page__empty-state-subtext">Set reminders when sending messages to stay connected</div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal for viewing all messages -->
  <div id="all-messages-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>All Messages</h2>
        <span class="close-modal">&times;</span>
      </div>
      <div class="modal-body">
        <div id="all-messages-list" class="home-page__messages all-messages-list">
          <!-- Will be populated via JS -->
        </div>
      </div>
    </div>
  </div>

  <!-- Modal for viewing all connections -->
  <div id="all-connections-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>All Connections</h2>
        <span class="close-modal">&times;</span>
      </div>
      <div class="modal-body">
        <div id="all-connections-list" class="home-page__connections all-connections-list">
          <!-- Will be populated via JS -->
        </div>
      </div>
    </div>
  </div>

  <!-- Modal for adding/editing connections -->
  <div id="connection-modal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 id="connection-modal-title">Add New Connection</h2>
        <span class="close-modal">&times;</span>
      </div>
      <div class="modal-body">
        <form id="connection-form">
          <input type="hidden" id="connection-id">
          
          <!-- Basic Information Section -->
          <div class="field-group">
            <h4>Basic Information</h4>
            <div class="form-group">
              <label for="connection-name">Name*</label>
              <input type="text" id="connection-name" class="input-field" placeholder="Enter name" required>
            </div>
            
            <!-- Primary Relationship Type -->
            <div class="form-group">
              <label for="connection-relationship">Relationship Type*</label>
              <select id="connection-relationship" class="input-field" required>
                <option value="">Select relationship type</option>
                <option value="family">Family</option>
                <option value="friend">Friend</option>
                <option value="partner">Partner/Romantic</option>
                <option value="colleague">Professional</option>
                <option value="acquaintance">Acquaintance</option>
                <option value="other">Other</option>
              </select>
            </div>
            
            <!-- Specific Relationship - dynamically shown based on primary type -->
            <div class="form-group" id="specific-relationship-container" style="display: none;">
              <label for="connection-specific-relationship">Specific Relationship</label>
              <select id="connection-specific-relationship" class="input-field">
                <option value="">Select specific relationship</option>
                <!-- Options will be dynamically populated based on primary relationship -->
              </select>
              <div class="field-help">Helps us create more personalized messages</div>
            </div>
            
            <div class="form-group">
              <label for="connection-years">Years Known</label>
              <input type="number" id="connection-years" class="input-field" min="0" max="100" placeholder="How many years have you known them?">
              <div class="field-help">Helps tailor messages to the depth of your relationship</div>
            </div>
          </div>
          
          <!-- Communication Preferences -->
          <div class="field-group">
            <h4>Communication Preferences</h4>
            <div class="form-group">
              <label for="connection-communication-style">Communication Style</label>
              <select id="connection-communication-style" class="input-field">
                <option value="">Select style (optional)</option>
                <option value="direct">Direct and straightforward</option>
                <option value="warm">Warm and emotional</option>
                <option value="formal">Formal and respectful</option>
                <option value="casual">Casual and relaxed</option>
                <option value="humorous">Humorous and playful</option>
              </select>
              <div class="field-help">Helps us match the tone of messages to their preferences</div>
            </div>
            
            <!-- Relationship Goal Field -->
            <div class="form-group">
              <label for="connection-goal">Relationship Focus</label>
              <select id="connection-goal" class="input-field">
                <option value="">Select focus (optional)</option>
                <option value="maintain">Maintain current connection</option>
                <option value="strengthen">Strengthen the relationship</option>
                <option value="reconnect">Reconnect after distance</option>
                <option value="deepen">Deepen emotional connection</option>
                <option value="support">Support through tough times</option>
                <option value="celebrate">Celebrate achievements</option>
                <option value="professional">Develop professional relationship</option>
              </select>
              <div class="field-help">Helps us craft messages that serve your relationship goals</div>
            </div>
          </div>
          
          <!-- Additional Notes -->
          <div class="field-group" style="border-bottom: none; margin-bottom: 10px;">
            <h4>Additional Notes</h4>
            <div class="form-group">
              <label for="connection-notes">Personal Notes</label>
              <textarea id="connection-notes" rows="3" placeholder="Any personal details or conversation topics they enjoy"></textarea>
              <div class="field-help">Add memorable moments, important life events, or topics they love discussing</div>
            </div>
          </div>
          
          <div class="modal-actions">
            <button type="button" id="cancel-connection" class="btn-secondary">Cancel</button>
            <button type="submit" class="btn-primary">Save</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <!-- Delete Confirmation Dialog -->
  <div id="delete-confirmation-dialog" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2>Delete Connection</h2>
        <span class="close-modal">&times;</span>
      </div>
      <div class="modal-body">
        <p>Are you sure you want to delete this connection?</p>
        <p class="warning-text">This action cannot be undone.</p>
      </div>
      <div class="modal-footer">
        <button class="modal-cancel-btn">Cancel</button>
        <button class="modal-confirm-btn">Delete</button>
      </div>
    </div>
  </div>

  <!-- Empty and Error States Templates -->
  <template id="loading-template">
    <div class="home-page__loading-state">
      <div class="home-page__loading-spinner"></div>
      <p class="home-page__loading-text">Loading...</p>
    </div>
  </template>

  <template id="error-state-template">
    <div class="home-page__error-state">
      <span class="material-icons home-page__error-icon">error_outline</span>
      <p class="home-page__error-text">Oops! Something went wrong.</p>
      <button class="home-page__retry-button">
        <span class="material-icons">refresh</span> Try Again
      </button>
    </div>
  </template>

  <template id="empty-state-template">
    <div class="home-page__empty-state">
      <span class="material-icons home-page__empty-icon">info</span>
      <h3 class="home-page__empty-title">Nothing to show</h3>
      <p class="home-page__empty-description">There's nothing here yet</p>
      <button class="home-page__action-button">Get Started</button>
    </div>
  </template>

  <!-- Loading Overlay -->
  <div id="loadingOverlay" class="loading-overlay">
    <div class="loading-spinner"></div>
    <p id="loadingContext" class="loading-text">Loading...</p>
  </div>

  <!-- Alert Message Container (will be populated dynamically) -->
  <div id="alertContainer"></div>

  <!-- JavaScript -->
  <script src="js/home.js"></script>
  <script src="js/animation.js"></script>
</body>
</html> 