(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[417],{7532:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/create",function(){return a(7798)}])},7798:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return CreatePage}});var r=a(5893),n=a(7294),o=a(1163),i=a(8549),s=a(3977),l=a(9451),c=a(6100);let d=(0,s.C6)().length?(0,s.C6)()[0]:(0,s.ZF)({apiKey:"AIzaSyBZiJPTs7dMccVgFV-YoTejnhy1bZNFEQY",authDomain:"heartglowai.firebaseapp.com",projectId:"heartglowai",storageBucket:"heartglowai.firebasestorage.app",messagingSenderId:"196565711798",appId:"1:196565711798:web:79e2b0320fd8e74ab0df17",measurementId:"G-KJMPL1DNPY"});(0,l.v0)(d);let h=(0,c.ad)(d);var g=a(6571);function RecipientStep(e){let{onNext:t}=e;console.log(">>> RecipientStep component rendering started");let{currentUser:a}=(0,i.a)(),[o,s]=(0,n.useState)([]),[l,d]=(0,n.useState)(!0),[u,m]=(0,n.useState)(null),[p,y]=(0,n.useState)(null);(0,n.useEffect)(()=>{let fetchRecipients=async()=>{if(a)try{let e=(0,c.hJ)(h,"users",a.uid,"connections"),t=(0,c.IO)(e),r=await (0,c.PL)(t),n=r.docs.map(e=>({id:e.id,...e.data()}));s(n)}catch(e){y("Failed to load recipients. Please try again."),console.error("Error fetching recipients:",e)}finally{d(!1)}};fetchRecipients()},[a]);let handleSelect=e=>{m(e)};return l?(0,r.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-heartglow-pink"})}):(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Who would you like to message?"}),(0,r.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Select a recipient from your connections"})]}),p&&(0,r.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 p-4 rounded-lg text-red-600 dark:text-red-400",children:p}),(0,r.jsx)("div",{className:"grid gap-4",children:0===o.length?(0,r.jsx)("div",{className:"text-center py-12",children:(0,r.jsx)("p",{className:"text-gray-500 dark:text-gray-400",children:"No recipients found. Add some connections first."})}):o.map(e=>(0,r.jsx)(g.E.div,{whileHover:{scale:1.02},whileTap:{scale:.98},className:"p-4 rounded-lg border cursor-pointer transition-colors ".concat((null==u?void 0:u.id)===e.id?"border-heartglow-pink bg-heartglow-pink/5":"border-gray-200 dark:border-gray-700 hover:border-heartglow-pink"),onClick:()=>handleSelect(e),children:(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white",children:e.name}),(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.relationship})]}),e.lastContact&&(0,r.jsxs)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:["Last contact: ",new Date(e.lastContact).toLocaleDateString()]})]})},e.id))}),(0,r.jsx)("div",{className:"flex justify-end",children:(0,r.jsx)("button",{onClick:()=>{u&&t({recipient:u})},disabled:!u,className:"px-4 py-2 rounded-lg font-medium ".concat(u?"bg-heartglow-pink text-white hover:bg-heartglow-pink/90":"bg-gray-200 dark:bg-gray-700 text-gray-500 cursor-not-allowed"),children:"Next"})})]})}let u=[{id:"check-in",title:"Check In",description:"A simple message to see how they're doing",icon:"\uD83D\uDC4B",color:"from-blue-400 to-blue-600"},{id:"gratitude",title:"Gratitude",description:"Express appreciation for their presence in your life",icon:"\uD83D\uDE4F",color:"from-heartglow-pink to-heartglow-violet"},{id:"support",title:"Support",description:"Offer help or encouragement during tough times",icon:"\uD83D\uDCAA",color:"from-green-400 to-teal-500"},{id:"celebration",title:"Celebration",description:"Share joy for their achievements or milestones",icon:"\uD83C\uDF89",color:"from-yellow-400 to-orange-500"},{id:"reconnection",title:"Reconnection",description:"Reach out after some time apart",icon:"\uD83E\uDD1D",color:"from-purple-400 to-indigo-500"},{id:"custom",title:"Custom",description:"Write your own message with a specific purpose",icon:"✍️",color:"from-gray-400 to-gray-600"}];function IntentStep(e){let{onNext:t,onBack:a}=e,[o,i]=(0,n.useState)(null),[s,l]=(0,n.useState)(""),[c,d]=(0,n.useState)(!1),handleSelect=e=>{i(e),d("custom"===e)};return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"What's the purpose of your message?"}),(0,r.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Select the intent that best matches your goal"})]}),(0,r.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:u.map(e=>(0,r.jsx)(g.E.div,{whileHover:{scale:1.02,boxShadow:"0 4px 6px rgba(0, 0, 0, 0.1)"},whileTap:{scale:.98},className:"p-4 rounded-lg border cursor-pointer transition-all ".concat(o===e.id?"border-heartglow-pink bg-heartglow-pink/5 dark:bg-heartglow-pink/10":"border-gray-200 dark:border-gray-700 hover:border-heartglow-pink"),onClick:()=>handleSelect(e.id),children:(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("div",{className:"flex items-center justify-center w-12 h-12 rounded-full bg-gradient-to-br ".concat(e.color," text-white text-2xl mr-3 shadow-sm"),children:e.icon}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white",children:e.title}),(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.description})]})]})},e.id))}),c&&(0,r.jsxs)(g.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mt-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Describe your custom intent"}),(0,r.jsx)("textarea",{value:s,onChange:e=>l(e.target.value),className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-800 dark:text-white",placeholder:"e.g., I want to invite them to a family event, I need to request time off from my manager...",rows:3,required:!0})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("button",{onClick:a,className:"px-4 py-2 rounded-lg font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white",children:"Back"}),(0,r.jsx)("button",{onClick:()=>{o&&t({intent:{type:o,custom:"custom"===o?s:void 0}})},disabled:!o||c&&!s,className:"px-4 py-2 rounded-lg font-medium ".concat(o&&(!c||s)?"bg-heartglow-pink text-white hover:bg-heartglow-pink/90":"bg-gray-200 dark:bg-gray-700 text-gray-500 cursor-not-allowed"),children:"Next"})]})]})}var create_FormatStep=e=>{let{onNext:t,onBack:a,initialData:o}=e,[i,s]=(0,n.useState)((null==o?void 0:o.format)||""),[l,c]=(0,n.useState)((null==o?void 0:o.length)||""),[d,h]=(0,n.useState)({emailSubject:"",emojiPreference:"moderate",talkingPoints:3,platform:"general"});return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Choose Format & Length"}),(0,r.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Select how your message will be delivered"})]}),(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:"Message Format"}),(0,r.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[{id:"text",label:"Text Message",icon:"\uD83D\uDCF1",description:"Simple message for direct delivery"},{id:"email",label:"Email",icon:"\uD83D\uDCE7",description:"Formal message with subject line"},{id:"conversation",label:"In-Person Conversation",icon:"\uD83D\uDCAC",description:"Talking points for face-to-face"},{id:"card",label:"Greeting Card",icon:"\uD83D\uDC8C",description:"Perfect for celebration or gratitude"},{id:"social",label:"Social Media",icon:"\uD83C\uDF10",description:"Public post or direct message"},{id:"letter",label:"Letter",icon:"✉️",description:"Traditional format for deep connection"}].map(e=>(0,r.jsxs)(g.E.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>s(e.id),className:"p-4 rounded-lg border cursor-pointer transition-colors ".concat(i===e.id?"border-heartglow-pink bg-heartglow-pink/5 dark:bg-heartglow-pink/10":"border-gray-200 dark:border-gray-700 hover:border-heartglow-pink"),children:[(0,r.jsxs)("div",{className:"flex items-center mb-2",children:[(0,r.jsx)("span",{className:"text-2xl mr-2",children:e.icon}),(0,r.jsx)("span",{className:"font-medium text-gray-900 dark:text-white",children:e.label})]}),(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.description})]},e.id))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-lg font-medium text-gray-900 dark:text-white mb-3",children:"Message Length"}),(0,r.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-4",children:[{id:"brief",label:"Brief",description:"1-2 sentences",icon:"\uD83D\uDD39"},{id:"standard",label:"Standard",description:"1 paragraph",icon:"\uD83D\uDD38"},{id:"detailed",label:"Detailed",description:"2-3 paragraphs",icon:"\uD83D\uDCDD"},{id:"extended",label:"Extended",description:"Full letter/email",icon:"\uD83D\uDCC4"}].map(e=>(0,r.jsxs)(g.E.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>c(e.id),className:"p-4 rounded-lg border cursor-pointer transition-colors ".concat(l===e.id?"border-heartglow-pink bg-heartglow-pink/5 dark:bg-heartglow-pink/10":"border-gray-200 dark:border-gray-700 hover:border-heartglow-pink"),children:[(0,r.jsx)("div",{className:"flex items-center justify-center mb-2",children:(0,r.jsx)("span",{className:"text-xl",children:e.icon})}),(0,r.jsx)("h4",{className:"font-medium text-center text-gray-900 dark:text-white",children:e.label}),(0,r.jsx)("p",{className:"text-sm text-center text-gray-500 dark:text-gray-400",children:e.description})]},e.id))})]}),i&&(()=>{switch(i){case"email":return(0,r.jsxs)(g.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-6 p-4 bg-gray-50 dark:bg-gray-800/30 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Email Subject"}),(0,r.jsx)("input",{type:"text",value:d.emailSubject,onChange:e=>h(t=>({...t,emailSubject:e.target.value})),className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white",placeholder:"Enter email subject"})]});case"text":return(0,r.jsxs)(g.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-6 p-4 bg-gray-50 dark:bg-gray-800/30 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Emoji Usage"}),(0,r.jsxs)("select",{value:d.emojiPreference,onChange:e=>h(t=>({...t,emojiPreference:e.target.value})),className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white",children:[(0,r.jsx)("option",{value:"none",children:"No emojis"}),(0,r.jsx)("option",{value:"minimal",children:"Minimal emojis"}),(0,r.jsx)("option",{value:"moderate",children:"Moderate emojis"}),(0,r.jsx)("option",{value:"frequent",children:"Frequent emojis"})]})]});case"conversation":return(0,r.jsxs)(g.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-6 p-4 bg-gray-50 dark:bg-gray-800/30 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Number of Talking Points"}),(0,r.jsx)("input",{type:"number",min:"1",max:"10",value:d.talkingPoints,onChange:e=>h(t=>({...t,talkingPoints:parseInt(e.target.value)})),className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white"})]});case"social":return(0,r.jsxs)(g.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"mt-6 p-4 bg-gray-50 dark:bg-gray-800/30 rounded-lg border border-gray-200 dark:border-gray-700",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Platform"}),(0,r.jsxs)("select",{value:d.platform,onChange:e=>h(t=>({...t,platform:e.target.value})),className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-700 text-gray-800 dark:text-white",children:[(0,r.jsx)("option",{value:"general",children:"General"}),(0,r.jsx)("option",{value:"twitter",children:"Twitter"}),(0,r.jsx)("option",{value:"instagram",children:"Instagram"}),(0,r.jsx)("option",{value:"facebook",children:"Facebook"}),(0,r.jsx)("option",{value:"linkedin",children:"LinkedIn"})]})]});default:return null}})()]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("button",{onClick:a,className:"px-4 py-2 rounded-lg font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white",children:"Back"}),(0,r.jsx)("button",{onClick:()=>{t({format:{type:i,length:l,options:d}})},disabled:!i||!l,className:"px-4 py-2 rounded-lg font-medium ".concat(i&&l?"bg-heartglow-pink text-white hover:bg-heartglow-pink/90":"bg-gray-200 dark:bg-gray-700 text-gray-500 cursor-not-allowed"),children:"Next"})]})]})},create_ToneStep=e=>{let{onNext:t,onBack:a,initialData:o}=e,[i,s]=(0,n.useState)((null==o?void 0:o.type)||""),[l,c]=(0,n.useState)((null==o?void 0:o.custom)||""),[d,h]=(0,n.useState)(!1);return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"text-center",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"What tone would you like to use?"}),(0,r.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Select the tone that best fits your message"})]}),(0,r.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[{id:"warm",label:"Warm",description:"Friendly and affectionate"},{id:"casual",label:"Casual",description:"Relaxed and informal"},{id:"sincere",label:"Sincere",description:"Honest and heartfelt"},{id:"playful",label:"Playful",description:"Light and fun"},{id:"formal",label:"Formal",description:"Professional and respectful"},{id:"reflective",label:"Reflective",description:"Thoughtful and introspective"},{id:"custom",label:"Custom",description:"Define your own tone"}].map(e=>(0,r.jsx)(g.E.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>{s(e.id),h("custom"===e.id)},className:"p-4 rounded-lg border cursor-pointer transition-colors ".concat(i===e.id?"border-heartglow-pink bg-heartglow-pink/5":"border-gray-200 dark:border-gray-700 hover:border-heartglow-pink"),children:(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"font-medium text-gray-900 dark:text-white",children:e.label}),(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:e.description})]})},e.id))}),d&&(0,r.jsxs)(g.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mt-4",children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-2",children:"Describe your desired tone"}),(0,r.jsx)("input",{type:"text",value:l,onChange:e=>c(e.target.value),className:"w-full p-3 border border-gray-300 dark:border-gray-600 rounded-lg bg-white dark:bg-gray-800 text-gray-800 dark:text-white",placeholder:"e.g., Encouraging, Empathetic, etc.",required:!0})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("button",{onClick:a,className:"px-4 py-2 rounded-lg font-medium text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white",children:"Back"}),(0,r.jsx)("button",{onClick:()=>{t({tone:{type:i,custom:d?l:null}})},disabled:!i||d&&!l,className:"px-4 py-2 rounded-lg font-medium ".concat(i&&(!d||l)?"bg-heartglow-pink text-white hover:bg-heartglow-pink/90":"bg-gray-200 dark:bg-gray-700 text-gray-500 cursor-not-allowed"),children:"Next"})]})]})};function AdvancedStep(e){let{onNext:t,onBack:a}=e,[o,i]=(0,n.useState)(3),[s,l]=(0,n.useState)("");return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold text-gray-900",children:"Advanced Options"}),(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Message Intensity (1-5)"}),(0,r.jsx)("input",{type:"range",min:"1",max:"5",value:o,onChange:e=>i(Number(e.target.value)),className:"w-full"}),(0,r.jsxs)("div",{className:"flex justify-between text-sm text-gray-500",children:[(0,r.jsx)("span",{children:"Subtle"}),(0,r.jsx)("span",{children:"Balanced"}),(0,r.jsx)("span",{children:"Intense"})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Custom Instructions (Optional)"}),(0,r.jsx)("textarea",{value:s,onChange:e=>l(e.target.value),className:"w-full p-2 border rounded-lg",rows:4,placeholder:"Add any specific instructions or preferences..."})]})]}),(0,r.jsxs)("div",{className:"flex justify-between",children:[(0,r.jsx)("button",{onClick:a,className:"px-4 py-2 rounded-md border border-gray-300 hover:bg-gray-50 text-gray-700 font-medium focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Back"}),(0,r.jsx)("button",{onClick:()=>{t({advanced:{intensity:o,customInstructions:s.trim()||null}})},className:"px-4 py-2 rounded-md bg-blue-600 hover:bg-blue-700 text-white font-medium focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2",children:"Next"})]})]})}let m=(0,n.createContext)({user:null,loading:!0,signIn:async()=>{},signOut:async()=>{}});var p=a(7004);function extractInsights(e,t){let{intent:a,tone:r,recipient:n}=t,o=["This message maintains a ".concat(r," tone that creates an authentic connection"),"The personalized content acknowledges your relationship as ".concat(n.relationship),"The language is emotionally intelligent and considerate"],i=[];switch(a.type){case"gratitude":i=["Expressing appreciation in a specific way makes the message feel genuine","This acknowledges their impact without creating obligation","The message balances warmth with respect for boundaries"];break;case"support":i=["Offering support without presuming to know exactly what they need","The message conveys presence without demanding a response","The tone provides comfort while respecting their agency"];break;case"celebration":i=["Recognizing their achievement with specific praise feels meaningful","The message focuses on their qualities rather than just outcomes","The tone balances excitement with sincerity"];break;case"reconnection":i=["Opening with warmth helps bridge the gap in communication","Acknowledging the time apart without dwelling on it creates safety","The message offers a path forward without pressure"];break;case"check-in":i=["The casual tone makes responding feel optional, not obligatory","Showing interest without prying creates emotional safety","Offering specific ways to connect makes following up easier"];break;default:i=["The message clearly communicates your intention in a thoughtful way","The tone matches the purpose while maintaining emotional intelligence","The content is focused and specific rather than generic"]}return[...i,...o].slice(0,3)}function generateMockMessage(e){let{recipient:t,intent:a,tone:r,format:n}=e,o={warm:["Dear ".concat(t.name),"My dear ".concat(t.name),"Dearest ".concat(t.name,",")],casual:["Hey ".concat(t.name),"Hi ".concat(t.name),"Hello there ".concat(t.name,",")],sincere:["".concat(t.name,","),"Dear ".concat(t.name,","),"My ".concat(t.relationship," ").concat(t.name,",")],playful:["Hey you!","".concat(t.name,"! \uD83D\uDE0A"),"Heya ".concat(t.name,"!")],formal:["Dear ".concat(t.name,","),"".concat(t.name,","),"Respected ".concat(t.name,",")],reflective:["".concat(t.name,","),"Dear ".concat(t.name,","),"My ".concat(t.relationship," ").concat(t.name,",")]},i={"check-in":["I've been thinking about you lately and wanted to see how you're doing. It's been a while since we caught up, and I'd love to hear what's been happening in your life.","Just wanted to reach out and check how things are going with you. I've been reflecting on our relationship as ".concat(t.relationship,", and thought I'd send a quick message."),"Life gets busy sometimes, but I wanted to take a moment to connect and see how you're doing. I value having you as my ".concat(t.relationship,", and I'd love to hear your updates.")],gratitude:["I wanted to take a moment to express my gratitude for having you in my life. As my ".concat(t.relationship,", you bring so much joy and meaning to my days. I appreciate all that you do and who you are."),"I've been reflecting lately on the people who make a difference in my life, and you immediately came to mind. I'm truly grateful for your presence and the way you ".concat(getRelationshipAttribute(t.relationship),"."),"Sometimes we don't say it enough, but I wanted you to know how thankful I am for you. Your ".concat(getRelationshipAttribute(t.relationship)," means more to me than you might realize.")],support:["I wanted to reach out and let you know that I'm here for you. Whatever you're going through right now, please remember that you don't have to face it alone. As your ".concat(t.relationship,", I'm ready to listen, help, or simply be present in whatever way you need."),"I've been thinking about you and wanted to remind you that you have my unwavering support. Life has its challenges, but you have the strength to overcome them, and I'll be right beside you along the way.","Just a note to say I'm in your corner. We all need support sometimes, and I want you to know that as your ".concat(t.relationship,", I'm here for you - whether you need practical help, a listening ear, or just someone to remind you of how capable you are.")],celebration:["I wanted to celebrate your recent achievement with you! What you've accomplished is truly impressive, and I'm so proud to be your ".concat(t.relationship,". Your hard work, talent, and perseverance have paid off beautifully."),"Congratulations on your success! It's been wonderful to witness your journey, and this achievement is so well-deserved. As your ".concat(t.relationship,", I couldn't be happier for you."),"I'm absolutely thrilled about your recent news! This achievement is a testament to your dedication and abilities. I'm honored to be your ".concat(t.relationship," and to celebrate this special moment with you.")],reconnection:["It's been too long since we connected, and I've been thinking about you. I value our relationship as ".concat(t.relationship,"s, and I'd love to bridge this gap and reconnect. How have you been?"),"I've been reflecting on important relationships in my life, and you came to mind immediately. It's been a while since we've been in touch, and I miss having you as part of my life. I'd love to hear how you've been.","Time has a way of slipping by, but some connections are worth rekindling. I've been thinking about our relationship as ".concat(t.relationship,"s, and I'd like to reach out and reconnect. Would you be open to catching up?")]},s={warm:["With love,","Warmly,","With affection,"],casual:["Talk soon,","Cheers,","See you around,"],sincere:["Sincerely,","With gratitude,","Truly yours,"],playful:["Until next time!","Catch you later!","With a smile,"],formal:["Respectfully,","Kind regards,","Best regards,"],reflective:["In appreciation,","With thought,","Contemplatively,"]},l="sincere",c=o[r]||o[l],d=s[r]||s[l],h=a.type in i?a.type:"gratitude",g=i[h],u=c[Math.floor(Math.random()*c.length)],m=g[Math.floor(Math.random()*g.length)],p=d[Math.floor(Math.random()*d.length)],y=function(e,t){let a=["I hope this message finds you well.","I've been thinking about our relationship as ".concat(t,"s lately."),"Something prompted me to reach out to you today.","I wanted to take a moment to connect with you."];return a[Math.floor(Math.random()*a.length)]}(0,t.relationship),x=function(e,t){let a={gratitude:["Thank you again for being you.","I'm so grateful for your presence in my life.","Your impact on my life deserves recognition."],support:["Remember, I'm here whenever you need me.","Please don't hesitate to reach out if you need anything.","I believe in your strength, but I'm here to support you too."],celebration:["Here's to your continued success!","I look forward to celebrating more of your achievements.","You should be incredibly proud of yourself."],reconnection:["I'd love to hear from you when you have time.","Perhaps we could catch up properly sometime soon?","I hope we can reconnect and rebuild our relationship."],"check-in":["Looking forward to hearing how you've been.","I'd love to catch up properly when you have time.","No pressure to respond immediately, but I'd love to hear from you."]}[t]||["Looking forward to connecting with you again soon.","Wishing you well in all things.","Until next time, take care of yourself."];return a[Math.floor(Math.random()*a.length)]}(0,a.type);return"email"===n.type?"\nSubject: ".concat(function(e,t){let a={gratitude:["A note of thanks","Gratitude for you, ".concat(t),"Appreciating our connection"],support:["Thinking of you","Here for you","Support and encouragement"],celebration:["Celebrating your success!","Congratulations!","In recognition of your achievement"],reconnection:["Reconnecting","Reaching out","Let's catch up"],"check-in":["Checking in","How have you been?","Just saying hello"]}[e]||["A message for ".concat(t),"Reaching out","Connecting with you"];return a[Math.floor(Math.random()*a.length)]}(a.type,t.name),"\n\n").concat(u,"\n\n").concat(y,"\n\n").concat(m,"\n\n").concat(x,"\n\n").concat(p,"\n").trim():"\n".concat(u,"\n\n").concat(m,"\n\n").concat(x,"\n\n").concat(p,"\n").trim()}function getRelationshipAttribute(e){let t=e.toLowerCase(),a={friend:["friendship","loyalty","understanding","shared laughter"],partner:["love","companionship","support","partnership"],family:["love","support","understanding","presence"],colleague:["collaboration","professionalism","support","insights"],mentor:["guidance","wisdom","support","belief in me"],mentee:["eagerness to learn","fresh perspective","growth","questions that make me think"],acquaintance:["occasional conversations","perspectives","connection","presence"]}[t]||["presence in my life","unique perspective","role in my life"];return a[Math.floor(Math.random()*a.length)]}async function generateMessage(e){try{let t=function(e){let{recipient:t,intent:a,format:r,tone:n,advanced:o}=e,i="Create a ".concat(r.length," message for ").concat(t.name," (").concat(t.relationship,").\n\n");return i+="Intent: ".concat(a.custom||a.type,"\n")+"Tone: ".concat(n,"\n")+"Format: ".concat(r.type,"\n"),(null==o?void 0:o.intensity)&&(i+="Intensity level: ".concat(o.intensity,"/5\n")),(null==o?void 0:o.customInstructions)&&(i+="Additional instructions: ".concat(o.customInstructions,"\n")),i+="\nPlease generate a thoughtful, personalized message that feels authentic and appropriate for this relationship."}(e);console.log("Generating message with prompt:",t);try{let a=(0,p.$C)(d),r=(0,p.V1)(a,"generateMessageV2"),n=await r({params:e,prompt:t}),o=n.data;if(o&&o.content)return{content:o.content,insights:o.insights||extractInsights(o.content,e)}}catch(e){console.warn("Error calling cloud function:",e)}console.warn("Falling back to mock generator");let a=generateMockMessage(e),r=extractInsights(a,e);return{content:a,insights:r}}catch(r){console.error("Error generating message:",r);let t=generateMockMessage(e),a=extractInsights(t,e);return{content:t,insights:a}}}async function openai_generateMessage(e){try{return generateMessage(e)}catch(e){throw console.error("Error generating message:",e),e}}async function openai_generateMessageDirect(e){try{return generateMessage(e)}catch(e){return console.error("Error in direct message generation:",e),{content:"Unable to generate a message at this time. Please try again later.",insights:[]}}}function MessageOutput(e){let{recipient:t,intent:a,format:o,tone:i,advanced:s}=e,[l,d]=(0,n.useState)(!0),[u,p]=(0,n.useState)(!1),[y,x]=(0,n.useState)(!1),[b,f]=(0,n.useState)(""),[w,k]=(0,n.useState)(!1),[v,j]=(0,n.useState)(""),[N,C]=(0,n.useState)([]),[I,S]=(0,n.useState)(null),{user:D}=(0,n.useContext)(m);(0,n.useEffect)(()=>{let generate=async()=>{try{let e;d(!0),S(null);let r={recipient:{name:t.name,relationship:t.relationship},intent:a,format:o,tone:i,advanced:s};try{e=await openai_generateMessage(r)}catch(t){console.warn("Cloud function failed, falling back to direct OpenAI:",t),e=await openai_generateMessageDirect(r)}j(e.content),C(e.insights)}catch(e){console.error("Error generating message:",e),S("Failed to generate message. Please try again.")}finally{d(!1)}};generate()},[t,a,o,i,s]);let handleCopyToClipboard=()=>{navigator.clipboard.writeText(v).then(()=>{x(!0),setTimeout(()=>x(!1),2e3)}).catch(e=>{console.error("Failed to copy message:",e)})},handleSave=async()=>{if(!D){f("You must be logged in to save messages");return}p(!0),f(""),k(!1),console.log("[handleSave] Attempting to save message for user:",D.uid),console.log("[handleSave] Recipient Data:",t);try{let e={content:v,recipientName:t.name,recipientId:t.id||null,relationship:t.relationship,intent:a.type,tone:i,intensity:(null==s?void 0:s.intensity)||3,createdAt:(0,c.Bt)(),insights:N,messageCategory:a.type,messageFormat:o.type,messageIntention:a.custom||a.type,messageConfigTimestamp:new Date().toISOString()};console.log("[handleSave] Saving data:",e);let r=await (0,c.ET)((0,c.hJ)(h,"users",D.uid,"messages"),e);console.log("[handleSave] Message saved successfully with ID:",r.id),k(!0)}catch(e){console.error("[handleSave] Error saving message:",e),f("Failed to save message. Please try again.")}finally{console.log("[handleSave] Setting isSaving to false."),p(!1)}};return l?(0,r.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-heartglow-pink mb-4"}),(0,r.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"Crafting your heartfelt message..."}),(0,r.jsx)("p",{className:"text-sm text-gray-500 dark:text-gray-400 mt-2",children:"This may take a moment"})]}):I?(0,r.jsxs)("div",{className:"text-center py-8",children:[(0,r.jsx)("div",{className:"w-16 h-16 bg-red-100 dark:bg-red-900/20 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,r.jsx)("h3",{className:"text-lg font-medium text-red-600 dark:text-red-400 mb-2",children:I}),(0,r.jsx)("button",{onClick:()=>window.location.reload(),className:"inline-flex items-center justify-center bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 font-medium rounded-full px-6 py-2",children:"Try Again"})]}):(0,r.jsxs)(g.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"space-y-6",children:[(0,r.jsxs)("div",{className:"text-center mb-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-bold text-gray-900 dark:text-white",children:"Your Message Is Ready"}),(0,r.jsxs)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:["Crafted for ",t.name," with ","email"===o.type?"an email":"a message"," that conveys ",a.type]})]}),(0,r.jsxs)("div",{className:"bg-white dark:bg-heartglow-deepgray p-6 rounded-lg shadow-md border border-gray-100 dark:border-gray-800",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,r.jsxs)("h3",{className:"text-lg font-semibold text-heartglow-charcoal dark:text-heartglow-offwhite",children:["Message for ",t.name]}),(0,r.jsx)("button",{onClick:handleCopyToClipboard,className:"text-sm px-3 py-1 rounded-full bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-600 transition-colors flex items-center",children:y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Copied!"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy"]})})]}),(0,r.jsx)("div",{className:"prose dark:prose-invert max-w-none bg-gray-50 dark:bg-gray-800/30 p-5 rounded-lg border border-gray-100 dark:border-gray-700",children:(0,r.jsx)("p",{className:"whitespace-pre-wrap text-gray-800 dark:text-gray-200",children:v})})]}),N.length>0&&(0,r.jsxs)("div",{className:"bg-white dark:bg-heartglow-deepgray p-6 rounded-lg shadow-md border border-gray-100 dark:border-gray-800",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-4 text-heartglow-charcoal dark:text-heartglow-offwhite",children:"Why This Message Works"}),(0,r.jsx)("ul",{className:"space-y-3",children:N.map((e,t)=>(0,r.jsxs)(g.E.li,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.1*t},className:"flex items-start",children:[(0,r.jsx)("div",{className:"min-w-[20px] h-5 flex items-center justify-center mr-2 mt-0.5",children:(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 text-heartglow-pink",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),(0,r.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:e})]},t))})]}),(0,r.jsxs)("div",{className:"flex flex-col sm:flex-row items-center gap-4",children:[(0,r.jsx)("button",{onClick:handleSave,disabled:u||!v,className:"w-full sm:w-auto px-6 py-3 rounded-full ".concat(u||!v?"bg-gray-300 dark:bg-gray-700 text-gray-500 dark:text-gray-400 cursor-not-allowed":"bg-gradient-to-r from-heartglow-pink to-heartglow-violet hover:from-heartglow-violet hover:to-heartglow-indigo text-white"," font-medium focus:outline-none focus:ring-2 focus:ring-heartglow-pink focus:ring-offset-2 transition-all duration-300 transform hover:-translate-y-1 flex justify-center items-center"),children:u?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Saving..."]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"})}),"Save Message"]})}),(0,r.jsx)("button",{onClick:handleCopyToClipboard,className:"w-full sm:w-auto px-6 py-3 rounded-full bg-white dark:bg-gray-800 text-gray-700 dark:text-gray-300 border border-gray-300 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700 font-medium transition-colors flex justify-center items-center",children:y?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2 text-green-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Copied to Clipboard"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"})}),"Copy to Clipboard"]})}),w&&(0,r.jsx)("span",{className:"text-green-600 dark:text-green-400 mt-2 sm:mt-0",children:"Message saved successfully!"}),b&&(0,r.jsx)("span",{className:"text-red-600 dark:text-red-400 mt-2 sm:mt-0",children:b})]}),(0,r.jsx)("div",{className:"text-center mt-8",children:(0,r.jsxs)("button",{onClick:()=>window.location.href="/dashboard",className:"text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors text-sm flex items-center mx-auto",children:[(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Return to Dashboard"]})})]})}function CreatePage(){console.log(">>> CreatePage component rendering started");let e=(0,o.useRouter)(),{currentUser:t,loading:a}=(0,i.a)(),[s,l]=(0,n.useState)(1),[c,d]=(0,n.useState)({recipient:null,intent:null,format:null,tone:null,advanced:null});if((0,n.useEffect)(()=>{if(e.isReady){let{intent:t,tone:a}=e.query;(t||a)&&(console.log(">>> Query params found:",{queryIntent:t,queryTone:a}),d(e=>({...e,intent:t?{type:t,custom:""}:e.intent,tone:a||e.tone})))}},[e.isReady,e.query]),a)return(0,r.jsx)("div",{className:"flex justify-center items-center min-h-screen",children:(0,r.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-heartglow-pink"})});if(!t)return e.push("/login"),null;let handleNext=e=>{d(t=>({...t,...e})),l(e=>e+1)},handleBack=()=>{l(e=>e-1)};return(0,r.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-heartglow-deepgray py-12",children:(0,r.jsx)("div",{className:"max-w-3xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,r.jsxs)(g.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white dark:bg-heartglow-deepgray rounded-lg shadow-sm p-6",children:[(0,r.jsx)("div",{className:"mb-8",children:(0,r.jsx)("div",{className:"flex items-center justify-between",children:[1,2,3,4,5].map(e=>(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("div",{className:"w-8 h-8 rounded-full flex items-center justify-center ".concat(e<s?"bg-heartglow-pink text-white":e===s?"bg-heartglow-violet text-white":"bg-gray-200 dark:bg-gray-700 text-gray-500"),children:e}),e<5&&(0,r.jsx)("div",{className:"h-1 w-12 ".concat(e<s?"bg-heartglow-pink":"bg-gray-200 dark:bg-gray-700")})]},e))})}),(()=>{switch(console.log(">>> CreatePage rendering step: ".concat(s)),s){case 1:return(0,r.jsx)(RecipientStep,{onNext:handleNext});case 2:return(0,r.jsx)(IntentStep,{onNext:handleNext,onBack:handleBack});case 3:return(0,r.jsx)(create_FormatStep,{onNext:handleNext,onBack:handleBack});case 4:return(0,r.jsx)(create_ToneStep,{onNext:handleNext,onBack:handleBack});case 5:return(0,r.jsx)(AdvancedStep,{onNext:handleNext,onBack:handleBack});case 6:return(0,r.jsx)(MessageOutput,{recipient:c.recipient,intent:c.intent,format:c.format,tone:c.tone,advanced:c.advanced});default:return null}})()]})})})}}},function(e){e.O(0,[700,4,774,888,179],function(){return e(e.s=7532)}),_N_E=e.O()}]);