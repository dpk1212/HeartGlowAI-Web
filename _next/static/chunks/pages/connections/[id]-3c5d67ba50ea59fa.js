(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[90],{5800:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/connections/[id]",function(){return r(8858)}])},8858:function(e,t,r){"use strict";r.r(t);var a=r(5893),s=r(7294),n=r(1163),o=r(9008),l=r.n(o),i=r(6571),d=r(1664),c=r.n(d),h=r(1810),g=r(9406),x=r(8549),m=r(6100),u=r(1798);let getRouteWithBasePath=e=>"".concat("/dashboard").concat(e),p=["Family","Friend","Partner","Colleague","Client","Mentor","Mentee","Neighbor","Other"];t.default=()=>{var e;let t=(0,n.useRouter)(),{id:r}=t.query,{currentUser:o}=(0,x.a)(),[d,y]=(0,s.useState)(null),[b,w]=(0,s.useState)(!0),[f,k]=(0,s.useState)(null),[j,v]=(0,s.useState)(!1),[N,C]=(0,s.useState)(!1),[S,R]=(0,s.useState)(""),[F,B]=(0,s.useState)(!1),[E,O]=(0,s.useState)(!1),[P,_]=(0,s.useState)(""),[D,G]=(0,s.useState)(p[0]),[M,W]=(0,s.useState)(""),[K,A]=(0,s.useState)(""),[H,L]=(0,s.useState)(),[T,Z]=(0,s.useState)(""),[z,q]=(0,s.useState)(""),[U,V]=(0,s.useState)("");(0,s.useEffect)(()=>{let fetchConnection=async()=>{if(o&&r)try{w(!0),k(null);let e=(0,m.JU)(u.db,"users/".concat(o.uid,"/connections/").concat(r)),t=await (0,m.QT)(e);if(t.exists()){let e={id:t.id,...t.data()};y(e),_(e.name||""),G(e.relationship||p[0]),W(e.otherRelationship||""),A(e.specificRelationship||""),L(e.yearsKnown),Z(e.communicationStyle||""),q(e.relationshipGoal||""),V(e.notes||"")}else k("Connection not found")}catch(e){console.error("Error fetching connection:",e),k(e.message||"Failed to load connection")}finally{w(!1)}};fetchConnection()},[o,r]);let handleUpdate=async e=>{if(e.preventDefault(),o&&d)try{if(B(!0),k(null),!P.trim()){k("Please enter a name");return}let e={id:d.id,name:P.trim(),relationship:D,..."Other"===D&&{otherRelationship:M.trim()},...K&&{specificRelationship:K.trim()},...void 0!==H&&{yearsKnown:H},...T&&{communicationStyle:T.trim()},...z&&{relationshipGoal:z.trim()},...U&&{notes:U.trim()}};await (0,u.HZ)(o,e),y({...d,...e}),v(!1),O(!0),setTimeout(()=>{O(!1)},3e3)}catch(e){console.error("Error updating connection:",e),k(e.message||"Failed to update connection. Please try again.")}finally{B(!1)}},handleDelete=async()=>{if(o&&d){if(S!==d.name){k("Please type the connection name to confirm deletion");return}try{B(!0),k(null),await (0,u.Rd)(o,d.id),t.push(getRouteWithBasePath("/dashboard"))}catch(e){console.error("Error deleting connection:",e),k(e.message||"Failed to delete connection. Please try again."),B(!1)}}};return b?(0,a.jsx)(g.Z,{children:(0,a.jsx)(h.Z,{children:(0,a.jsx)("div",{className:"flex justify-center items-center py-20",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-heartglow-pink"})})})}):f&&!d?(0,a.jsx)(g.Z,{children:(0,a.jsx)(h.Z,{children:(0,a.jsxs)("div",{className:"text-center py-20",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-red-100 dark:bg-red-900/20 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,a.jsx)("h3",{className:"text-lg font-medium text-red-600 dark:text-red-400 mb-2",children:f}),(0,a.jsx)("div",{className:"mt-6",children:(0,a.jsx)(c(),{href:getRouteWithBasePath("/dashboard"),className:"px-6 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-200",children:"Back to Dashboard"})})]})})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(l(),{children:[(0,a.jsxs)("title",{children:[(null==d?void 0:d.name)||"Connection"," | HeartGlow AI"]}),(0,a.jsx)("meta",{name:"description",content:"View connection details in HeartGlow AI"})]}),(0,a.jsx)(g.Z,{children:(0,a.jsx)(h.Z,{children:(0,a.jsxs)("div",{className:"max-w-3xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center mb-2",children:[(0,a.jsxs)(c(),{href:getRouteWithBasePath("/connections"),className:"text-heartglow-indigo dark:text-heartglow-pink hover:underline flex items-center mr-3",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"Back"]}),j?(0,a.jsx)("h1",{className:"text-3xl font-bold text-heartglow-charcoal dark:text-white",children:"Edit Connection"}):(0,a.jsx)("h1",{className:"text-3xl font-bold text-heartglow-charcoal dark:text-white",children:"Connection Details"})]}),!j&&(0,a.jsxs)("p",{className:"text-gray-600 dark:text-gray-300",children:["View and manage your connection with ",null==d?void 0:d.name]})]}),(0,a.jsxs)(i.E.div,{className:"bg-white dark:bg-heartglow-deepgray rounded-xl shadow-md border border-gray-100 dark:border-gray-800 p-6",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:[E&&(0,a.jsx)("div",{className:"mb-6 p-4 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg text-green-600 dark:text-green-400",children:"Connection updated successfully!"}),f&&(0,a.jsx)("div",{className:"mb-6 p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-600 dark:text-red-400",children:f}),j?(0,a.jsxs)("form",{onSubmit:handleUpdate,children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsxs)("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Name ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"text",id:"name",value:P,onChange:e=>_(e.target.value),className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-heartglow-pink focus:border-transparent",placeholder:"Enter their name",required:!0})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"relationship",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Relationship ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("select",{id:"relationship",value:D,onChange:e=>G(e.target.value),className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-heartglow-pink focus:border-transparent",required:!0,children:p.map(e=>(0,a.jsx)("option",{value:e,children:e},e))})]}),"Other"===D&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{htmlFor:"otherRelationship",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Specify Relationship ",(0,a.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,a.jsx)("input",{type:"text",id:"otherRelationship",value:M,onChange:e=>W(e.target.value),className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-heartglow-pink focus:border-transparent",placeholder:"Specify their relationship to you",required:"Other"===D})]}),(0,a.jsxs)("div",{className:"Other"===D?"col-span-2":"col-span-1",children:[(0,a.jsx)("label",{htmlFor:"specificRelationship",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Specific Relationship (Optional)"}),(0,a.jsx)("input",{type:"text",id:"specificRelationship",value:K,onChange:e=>A(e.target.value),className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-heartglow-pink focus:border-transparent",placeholder:"E.g. Brother, Boss, Best friend"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"yearsKnown",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Years Known (Optional)"}),(0,a.jsx)("input",{type:"number",id:"yearsKnown",value:H||"",onChange:e=>L(e.target.value?parseInt(e.target.value):void 0),min:"0",className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-heartglow-pink focus:border-transparent",placeholder:"How many years have you known them?"})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{htmlFor:"communicationStyle",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Communication Style (Optional)"}),(0,a.jsx)("input",{type:"text",id:"communicationStyle",value:T,onChange:e=>Z(e.target.value),className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-heartglow-pink focus:border-transparent",placeholder:"How do they prefer to communicate?"})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{htmlFor:"relationshipGoal",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Relationship Goal (Optional)"}),(0,a.jsx)("input",{type:"text",id:"relationshipGoal",value:z,onChange:e=>q(e.target.value),className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-heartglow-pink focus:border-transparent",placeholder:"What do you hope to achieve in this relationship?"})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("label",{htmlFor:"notes",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:"Notes (Optional)"}),(0,a.jsx)("textarea",{id:"notes",value:U,onChange:e=>V(e.target.value),rows:4,className:"w-full px-4 py-2 rounded-lg border border-gray-300 dark:border-gray-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-heartglow-pink focus:border-transparent",placeholder:"Any other details about this person you'd like to remember"})]})]}),(0,a.jsxs)("div",{className:"mt-8 flex justify-end space-x-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>v(!1),className:"px-6 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-200",children:"Cancel"}),(0,a.jsx)("button",{type:"submit",disabled:F,className:"px-6 py-2 bg-gradient-to-r from-heartglow-pink to-heartglow-violet text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-200 flex items-center ".concat(F?"opacity-70 cursor-not-allowed":""),children:F?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):"Save Changes"})]})]}):N?(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"p-4 bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg text-red-600 dark:text-red-400 mb-6",children:[(0,a.jsx)("p",{className:"font-medium",children:"Are you sure you want to delete this connection?"}),(0,a.jsx)("p",{className:"mt-2",children:"This action cannot be undone. All message history with this connection will remain, but they will no longer appear in your connections list."})]}),(0,a.jsxs)("div",{className:"mt-4 mb-6",children:[(0,a.jsxs)("label",{htmlFor:"deleteConfirmation",className:"block text-sm font-medium text-gray-700 dark:text-gray-300 mb-1",children:["Type ",(0,a.jsx)("span",{className:"font-medium",children:null==d?void 0:d.name})," to confirm"]}),(0,a.jsx)("input",{type:"text",id:"deleteConfirmation",value:S,onChange:e=>R(e.target.value),className:"w-full px-4 py-2 rounded-lg border border-red-300 dark:border-red-700 bg-white dark:bg-gray-800 text-gray-900 dark:text-white focus:ring-2 focus:ring-red-500 focus:border-transparent",placeholder:"Type ".concat(null==d?void 0:d.name," to confirm")})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>C(!1),className:"px-6 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-200",children:"Cancel"}),(0,a.jsx)("button",{type:"button",onClick:handleDelete,disabled:F||S!==(null==d?void 0:d.name),className:"px-6 py-2 bg-red-600 text-white rounded-lg shadow-md hover:bg-red-700 transition-colors duration-200 flex items-center ".concat(F||S!==(null==d?void 0:d.name)?"opacity-70 cursor-not-allowed":""),children:F?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[(0,a.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),(0,a.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Deleting..."]}):"Delete Connection"})]})]}):(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center mb-6",children:[(0,a.jsx)("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-heartglow-pink to-heartglow-violet flex items-center justify-center text-white text-4xl font-semibold shadow-md mr-6",children:null==d?void 0:null===(e=d.name)||void 0===e?void 0:e.substring(0,2).toUpperCase()}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-heartglow-charcoal dark:text-white",children:null==d?void 0:d.name}),(0,a.jsxs)("p",{className:"text-gray-600 dark:text-gray-400",children:[(null==d?void 0:d.relationship)==="Other"?null==d?void 0:d.otherRelationship:null==d?void 0:d.relationship,(null==d?void 0:d.specificRelationship)&&" (".concat(d.specificRelationship,")")]}),(null==d?void 0:d.lastMessageDate)&&(0,a.jsxs)("p",{className:"text-sm text-heartglow-pink mt-1",children:["Last message: ",(0,u.SY)(d.lastMessageDate)]})]})]}),(0,a.jsxs)("div",{className:"border-t border-gray-200 dark:border-gray-700 pt-6 pb-2",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold text-heartglow-charcoal dark:text-white mb-4",children:"Details"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(null==d?void 0:d.yearsKnown)!==void 0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Years Known"}),(0,a.jsxs)("p",{className:"text-heartglow-charcoal dark:text-white",children:[d.yearsKnown," ",1===d.yearsKnown?"year":"years"]})]}),(null==d?void 0:d.messageCount)!==void 0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Messages Sent"}),(0,a.jsxs)("p",{className:"text-heartglow-charcoal dark:text-white",children:[d.messageCount," ",1===d.messageCount?"message":"messages"]})]}),(null==d?void 0:d.communicationStyle)&&(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Communication Style"}),(0,a.jsx)("p",{className:"text-heartglow-charcoal dark:text-white",children:d.communicationStyle})]}),(null==d?void 0:d.relationshipGoal)&&(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Relationship Goal"}),(0,a.jsx)("p",{className:"text-heartglow-charcoal dark:text-white",children:d.relationshipGoal})]}),(null==d?void 0:d.notes)&&(0,a.jsxs)("div",{className:"col-span-2 mt-2",children:[(0,a.jsx)("h4",{className:"text-sm font-medium text-gray-500 dark:text-gray-400",children:"Notes"}),(0,a.jsx)("p",{className:"text-heartglow-charcoal dark:text-white whitespace-pre-wrap",children:d.notes})]})]})]}),(0,a.jsxs)("div",{className:"flex justify-between mt-8",children:[(0,a.jsx)(c(),{href:getRouteWithBasePath("/create?recipient=".concat(null==d?void 0:d.id)),className:"px-6 py-2 bg-gradient-to-r from-heartglow-pink to-heartglow-violet text-white rounded-lg shadow-md hover:shadow-lg transition-all duration-200",children:"Create Message"}),(0,a.jsxs)("div",{className:"flex space-x-4",children:[(0,a.jsx)("button",{type:"button",onClick:()=>C(!0),className:"px-6 py-2 bg-red-100 dark:bg-red-900/20 text-red-600 dark:text-red-400 rounded-lg hover:bg-red-200 dark:hover:bg-red-900/40 transition-colors duration-200",children:"Delete"}),(0,a.jsx)("button",{type:"button",onClick:()=>v(!0),className:"px-6 py-2 bg-gray-200 dark:bg-gray-700 text-gray-800 dark:text-gray-200 rounded-lg hover:bg-gray-300 dark:hover:bg-gray-600 transition-colors duration-200",children:"Edit"})]})]})]})]})]})})})]})}}},function(e){e.O(0,[424,571,608,774,888,179],function(){return e(e.s=5800)}),_N_E=e.O()}]);